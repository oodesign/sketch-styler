{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./node_modules/@skpm/fs/index.js","webpack://exports/./node_modules/@skpm/fs/utils.js","webpack://exports/./node_modules/@skpm/promise/index.js","webpack://exports/./node_modules/d3-color/src/color.js","webpack://exports/./node_modules/d3-color/src/cubehelix.js","webpack://exports/./node_modules/d3-color/src/define.js","webpack://exports/./node_modules/d3-color/src/index.js","webpack://exports/./node_modules/d3-color/src/lab.js","webpack://exports/./node_modules/d3-color/src/math.js","webpack://exports/./node_modules/delta-e/src/dE00.js","webpack://exports/./node_modules/delta-e/src/dE76.js","webpack://exports/./node_modules/delta-e/src/dE94.js","webpack://exports/./node_modules/delta-e/src/index.js","webpack://exports/./node_modules/mocha-js-delegate/index.js","webpack://exports/./node_modules/sketch-module-web-view/lib/browser-api.js","webpack://exports/./node_modules/sketch-module-web-view/lib/constants.js","webpack://exports/./node_modules/sketch-module-web-view/lib/dispatch-first-click.js","webpack://exports/./node_modules/sketch-module-web-view/lib/execute-javascript.js","webpack://exports/./node_modules/sketch-module-web-view/lib/fitSubview.js","webpack://exports/./node_modules/sketch-module-web-view/lib/index.js","webpack://exports/./node_modules/sketch-module-web-view/lib/inject-client-messaging.js","webpack://exports/./node_modules/sketch-module-web-view/lib/movable-area.js","webpack://exports/./node_modules/sketch-module-web-view/lib/parseWebArguments.js","webpack://exports/./node_modules/sketch-module-web-view/lib/set-delegates.js","webpack://exports/./node_modules/sketch-module-web-view/lib/webview-api.js","webpack://exports/./node_modules/sketch-module-web-view/remote.js","webpack://exports/./resources/register.html","webpack://exports/./resources/settings.html","webpack://exports/./resources/webview.html","webpack://exports/./src/AssignStylesAutomatically.js","webpack://exports/./src/EditSettings.js","webpack://exports/./src/StylesHelpers.js","webpack://exports/external \"buffer\"","webpack://exports/external \"events\"","webpack://exports/external \"sketch/ui\""],"names":["StylesHelpers","require","webviewIdentifier","webviewRegIdentifier","Settings","globalTextLayers","globalByArtb","globalTriggeredAction","actionScope","DOCUMENT","globalRemainingDays","globalIsInTrial","globalIsExpired","globalIsOver","onHowStylerWorks","context","NSWorkspace","sharedWorkspace","openURL","NSURL","URLWithString","onReportIssue","onReportLicenseIssue","subject","encodeURI","body","onScanLayer","clog","LoadSettings","analytics","isTextLayer","selection","length","textLayer","firstObject","isKindOfClass","MSTextLayer","sharedStyle","LAYER","onValidate","UI","message","onScanArtboard","isArtboard","artboard","MSArtboardGroup","ARTBOARD","onScanPage","isPageSearchable","page","document","currentPage","PAGE","onScanDocument","EditSettings","_0xd76e","_0xb471x2","_0xb471x3","ExiGuthrie","scanTextLayers","showRegistration","_0xb471x4","IsInTrial","_0xb471x5","Date","parseInt","_0xb471x6","_0xb471x7","Math","options","identifier","width","height","show","titleBarStyle","regWindow","BrowserWindow","webContentsReg","webContents","_0xbf12","JSON","console","_0x875bx1","_0x875bx2","Guthrie","_0x875bx3","MSPluginManager","_0x875bx4","onShutdown","on","s","loadURL","browserWindow","once","libraries","NSApp","delegate","librariesController","activeLibraries","forEach","lib","enabled","push","name","libraryID","getLibrariesEnabled","executeJavaScript","stringify","catch","error","layerID","matchingStyleIndex","markupLayerID","index","indexOfTextLayer","thumbnail","getTextStyleDummyThumbnail","matchingStyles","textStyle","style","stringValue","checkSameFont","checkSameWeight","includeSimilarWeights","checkSameSize","includeSimilarSize","checkSameColor","includeSimilarColor","checkSameParagraphSpacing","checkSameLineHeight","checkSameAlignment","checkSameCharacterSpacing","checkedActiveLibraries","unstyledTextLayers","textStyles","getDefinedTextStyles","allTextLayers","getAllTextLayers","stylesArranged","getStylesArranged","totalmatchingstyles","i","matchingStylesWithArranged","findMatchInArranged","layerThumbnail","getBase64","frame","objectID","j","sendColor","contrastBackground","attributes","MSAttributedStringColorAttribute","hexValue","shouldEnableContrastMode","NSFont","familyName","pointSize","styleLoaded","sendLayerColor","sendFontName","sendFontSize","sendContrast","firstCheckForStyle","toString","parentArtboard","percent","groupByArtboard","groupBy","byArtb","targetProgress","layersWithNoMatches","key","array","reduce","objectsByKeyValue","obj","value","concat","stylesAsigned","glob_unstyledTextLayers","ref_unstyledTextLayers","assignStyle","setSharedStyle","webviewID","existingWebview","getWebview","close","Helpers","webviewEsIdentifier","globalSettingsFile","optionss","remembersWindowFrame","getSettings","getLogsEnabled","logsEnabled","librariesEnabledByDefault","_0xeafa","jsonDef","DeltaE","D3","fs","stylePrecision","EXACT","SIMILAR","valStatus","app","no","over","similarFontSizeThreshold","similarFontWeightThreshold","similarColorDeltaEThreshold","settingsFile","localTextStyles","documentData","layerTextStyles","objects","count","objectAtIndex","foreignTextStyles","localObject","indexOfForeign","indexOfForeignStyle","sourceLibraryName","localShareID","remoteShareID","correlativeStyles","includeExternalLibraries","checked","libraryIndex","indexOfIncludedLibrary","libraryStyle","alreadyInList","sort","compareStyleArrays","originalStyle","localeCompare","suggestedString","layer","new","addLayer","setWidth","setHeight","setTextBehaviour","textBehaviour","image","getThumbnail","base64","getNSImageData","removeFromParent","reloadInspector","element","exportRequest","MSExportRequest","exportRequestsFromExportableLayer_inRect_useIDForName_","absoluteInfluenceRect","format","scaleX","rect","size","scaleY","scale","colorSpace","NSColorSpace","sRGBColorSpace","exporter","MSExporter","exporterForRequest_colorSpace_","imageRep","bitmapImageRep","NSImage","alloc","init","autorelease","addRepresentation","a","b","color","theme","getTheme","labReferenceColor","lab","labComparisonColor","color1","L","l","A","B","color2","deltaE","getDeltaE76","parseFloat","getImageData64","data","imageData","mimeType","NSString","stringWithFormat","base64EncodedStringWithOptions","nsImage","cgRef","CGImageForProposedRect_context_hints","nil","newRep","NSBitmapImageRep","initWithCGImage","setSize","pngData","representationUsingType_properties","NSPNGFileType","getTextLayerLayer","onlyUnstyledTexts","layers","NSMutableArray","addObject","getDocumentLayers","pages","children","className","predicate","NSPredicate","predicateWithFormat","instances","filteredArrayUsingPredicate","instanceLoop","objectEnumerator","instance","nextObject","getArtboardLayers","getPageLayers","triggeredAction","styles","alreadyHandledStyles","indexOf","similarStylesToThisOne","findSimilarTextStylesToThisOne","similarStyle","referenceLayer","arrangedStyles","isSimilarStyle","referenceStyle","comparisonStyle","sameFont","isSameFont","sameWeight","isSameWeight","sameSize","isSameSize","sameColor","isSameColor","sameParagraphSpacing","isSameParagraphSpacing","sameLineHeight","isSameLineHeight","sameAlignment","isSameAlignment","sameCharacterSpacing","isSameCharacterSpacing","isSimilar","precision","firstCheckForComparison","isSame","ref","NSFontManager","sharedFontManager","weightOfFont_","referenceWeight","comparisonWeight","lowerLimit","upperLimit","referenceSize","comparisonSize","referenceColor","comparisonColor","NSParagraphStyle","paragraphSpacing","e","minimumLineHeight","alignment","NSKern","similarStyles","containsIDOrViceversa","indexOfTextStyle","indexOfSimilarTextStyle","containsObject","contains","filter","id1","id2","splitId2","split","compareId2","replace","splitId1","compareId1","_0x802a","curl_async","_0xea21x2","_0xea21x3","_0xea21x4","NSTask","_0xea21x5","NSPipe","_0xea21x6","_0xea21x7","_0xea21x8","_0xea21x9","NSUTF8StringEncoding","_0xea21xa","_0xea21xb","_0xea21xc","tryParseJSON","jsonString","o","parse","writeTextToFile","text","filePath","t","f","writeFileSync","encoding","readFromFile","readFileSync","jsonFromFile","mutable","read","_0x2589","_0xa485x2","_0xa485x4","_0xa485x6","_0xa485x7","_0xa485x8","action","res","track","ec","ea","log","_0xec8c","module","exports"],"mappings":";;;;;;;;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;AACA;AACA,aAAa,mBAAO,CAAC,sBAAQ;AAC7B,YAAY,mBAAO,CAAC,iDAAS;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mBAAmB,OAAO;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;AClbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC9JA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA,aAAa,SAAS;AACtB;AACA,aAAa,kBAAkB;AAC/B;AACA,aAAa,kBAAkB;AAC/B;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC,SAAS;AAC9C;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;AC9QA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2C;;AAEpC;;AAEA;AACA;;AAEP;AACA;AACA;AACA,yBAAyB,IAAI;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0DAAM;AACN;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEO;AACP;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA,0DAAM,WAAW,yDAAM;AACvB;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,0DAAM,WAAW,yDAAM;AACvB;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2C;AACyB;AACzB;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,6CAAG,OAAO,4DAAU;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,gDAAO;AACzC;AACA;;AAEe;AACf;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA,0DAAM,uBAAuB,yDAAM,CAAC,+CAAK;AACzC;AACA,oBAAoB,kDAAQ,YAAY,kDAAQ;AAChD;AACA,GAAG;AACH;AACA,oBAAoB,gDAAM,YAAY,gDAAM;AAC5C;AACA,GAAG;AACH;AACA,iDAAiD,gDAAO;AACxD;AACA;AACA;AACA;AACA,eAAe,6CAAG;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;AC5DD;AAAA;AAAe;AACf;AACA;AACA,CAAC;;AAEM;AACP;AACA;AACA;AACA;;;;;;;;;;;;;ACTA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAsD;AACE;AACJ;;;;;;;;;;;;;ACFpD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA2C;AACO;AACP;;AAE3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,6CAAG,OAAO,4DAAU;AACzC;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;;AAEO;AACP;AACA;;AAEe;AACf;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA,0DAAM,WAAW,yDAAM,CAAC,+CAAK;AAC7B;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,6CAAG;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iCAAiC,gDAAO;AACxC;AACA;;AAEO;AACP;AACA;;AAEO;AACP;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,gDAAO;AACvB;AACA;;AAEA,0DAAM,WAAW,yDAAM,CAAC,+CAAK;AAC7B;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;AC1HD;AAAA;AAAA;AAAO;AACA;;;;;;;;;;;;;ACDM;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA,QAAQ,iBAAiB;AACzB,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA,sB;;;;;;;;;;;;ACxTa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA,QAAQ,iBAAiB;AACzB,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,sB;;;;;;;;;;;;AC7Ca;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA,QAAQ,iBAAiB;AACzB,QAAQ,kBAAkB;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,sB;;;;;;;;;;;;AC3Ha;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB,oBAAoB;AACpB;AACA;AACA;AACA,WAAW,mBAAO,CAAC,kDAAQ;AAC3B,WAAW,mBAAO,CAAC,kDAAQ;AAC3B,WAAW,mBAAO,CAAC,kDAAQ;;AAE3B;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,aAAa,OAAO;AACpB;AACA,oBAAoB;AACpB,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,aAAa,OAAO;AACpB;AACA,oBAAoB;AACpB,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,aAAa,OAAO;AACpB;AACA,oBAAoB;AACpB,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4B;;;;;;;;;;;ACjGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,wDAAwD,EAAE;AACxE;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,uCAAuC;AACvC;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,oCAAoC,+BAA+B;AACnE;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO,+BAA+B;AACtC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,oCAAoC,aAAa;AACjD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACRA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,yCAAyC;AACzC,uDAAuD;AACvD,6DAA6D;AAC7D,+BAA+B;AAC/B,MAAM;AACN;AACA;AACA;AACA,QAAQ;AACR,gBAAgB;AAChB,MAAM,eAAe;AACrB,0CAA0C,cAAc;AACxD,MAAM;AACN;AACA;;;;;;;;;;;;ACzBA,+DAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B,YAAY;AACZ,gCAAgC;AAChC,wFAAwF;AACxF,qCAAqC;AACrC;AACA;AACA,mBAAmB;AACnB,YAAY;AACZ,kCAAkC;AAClC;AACA;AACA,kBAAkB;AAClB,YAAY;AACZ,UAAU,OAAO;AACjB;AACA;AACA,kBAAkB;AAClB,UAAU;AACV,QAAQ,cAAc;AACtB;AACA;AACA,kBAAkB;AAClB,QAAQ;AACR,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACvHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrBA;AACA;AACA,mBAAmB,mBAAO,CAAC,sBAAQ;AACnC,sBAAsB,mBAAO,CAAC,+EAAe;AAC7C,kBAAkB,mBAAO,CAAC,+EAAe;AACzC,uBAAuB,mBAAO,CAAC,6EAAc;AAC7C,yBAAyB,mBAAO,CAAC,iGAAwB;AACzD,4BAA4B,mBAAO,CAAC,uGAA2B;AAC/D,kBAAkB,mBAAO,CAAC,iFAAgB;AAC1C,wBAAwB,mBAAO,CAAC,6FAAsB;AACtD,mBAAmB,mBAAO,CAAC,mFAAiB;;AAE5C;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;;;;;;;;;;ACxWA,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA,qDAAqD;AACrD,gDAAgD;AAChD,yBAAyB;AACzB;AACA,QAAQ;AACR,uDAAuD;AACvD,6CAA6C;AAC7C,0BAA0B;AAC1B,sDAAsD;AACtD;AACA;AACA,uBAAuB;AACvB;AACA;AACA,sBAAsB;AACtB;AACA;AACA,wCAAwC;AACxC,QAAQ,EAAE;AACV,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACjCA,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA,mBAAmB;AACnB,yDAAyD;AACzD;AACA,kCAAkC;AAClC,2CAA2C,4BAA4B,eAAe;AACtF,gCAAgC,yBAAyB,cAAc;AACvE;AACA,OAAO;AACP;AACA,8BAA8B;AAC9B,qDAAqD,SAAS;AAC9D;AACA;AACA,QAAQ;AACR,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;;;;;;;;;;;AC/DA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AClBA,+DAAgB,mBAAO,CAAC,oEAAmB;AAC3C,wBAAwB,mBAAO,CAAC,2FAAqB;AACrD,gBAAgB,mBAAO,CAAC,2EAAa;;AAErC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA,2CAA2C;AAC3C,OAAO;;AAEP;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,UAAU;;AAEV;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;;AAEH;AACA,+DAA+D;AAC/D;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,KAAK;AACL,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAuB,sBAAsB;;AAE7C;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,OAAO;AACP;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;;;;;;;;;;;;AChZA,mBAAmB,mBAAO,CAAC,sBAAQ;AACnC,wBAAwB,mBAAO,CAAC,6FAAsB;;AAEtD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD;AACnD;AACA,QAAQ,kCAAkC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;ACrOA;AACA;;AAEA;AACA,SAAS,mBAAO,CAAC,iEAAO;AACxB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AClCA,gM;;;;;;;;;;;ACA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","file":"__AssignStylesAutomatically.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/AssignStylesAutomatically.js\");\n","// TODO: async. Should probably be done with NSFileHandle and some notifications\n// TODO: file descriptor. Needs to be done with NSFileHandle\nvar Buffer = require(\"buffer\").Buffer;\nvar utils = require(\"./utils\");\nvar parseStat = utils.parseStat;\nvar fsError = utils.fsError;\nvar fsErrorForPath = utils.fsErrorForPath;\nvar encodingFromOptions = utils.encodingFromOptions;\nvar NOT_IMPLEMENTED = utils.NOT_IMPLEMENTED;\n\nmodule.exports.constants = {\n  F_OK: 0,\n  R_OK: 4,\n  W_OK: 2,\n  X_OK: 1\n};\n\nmodule.exports.access = NOT_IMPLEMENTED(\"access\");\n\nmodule.exports.accessSync = function(path, mode) {\n  mode = mode | 0;\n  var fileManager = NSFileManager.defaultManager();\n\n  switch (mode) {\n    case 0:\n      canAccess = module.exports.existsSync(path);\n      break;\n    case 1:\n      canAccess = Boolean(Number(fileManager.isExecutableFileAtPath(path)));\n      break;\n    case 2:\n      canAccess = Boolean(Number(fileManager.isWritableFileAtPath(path)));\n      break;\n    case 3:\n      canAccess =\n        Boolean(Number(fileManager.isExecutableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isWritableFileAtPath(path)));\n      break;\n    case 4:\n      canAccess = Boolean(Number(fileManager.isReadableFileAtPath(path)));\n      break;\n    case 5:\n      canAccess =\n        Boolean(Number(fileManager.isReadableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isExecutableFileAtPath(path)));\n      break;\n    case 6:\n      canAccess =\n        Boolean(Number(fileManager.isReadableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isWritableFileAtPath(path)));\n      break;\n    case 7:\n      canAccess =\n        Boolean(Number(fileManager.isReadableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isWritableFileAtPath(path))) &&\n        Boolean(Number(fileManager.isExecutableFileAtPath(path)));\n      break;\n  }\n\n  if (!canAccess) {\n    throw new Error(\"Can't access \" + String(path));\n  }\n};\n\nmodule.exports.appendFile = NOT_IMPLEMENTED(\"appendFile\");\n\nmodule.exports.appendFileSync = function(file, data, options) {\n  if (!module.exports.existsSync(file)) {\n    return module.exports.writeFileSync(file, data, options);\n  }\n\n  var handle = NSFileHandle.fileHandleForWritingAtPath(file);\n  handle.seekToEndOfFile();\n\n  var encoding = encodingFromOptions(options, \"utf8\");\n\n  var nsdata = Buffer.from(\n    data,\n    encoding === \"NSData\" || encoding === \"buffer\" ? undefined : encoding\n  ).toNSData();\n\n  handle.writeData(nsdata);\n};\n\nmodule.exports.chmod = NOT_IMPLEMENTED(\"chmod\");\n\nmodule.exports.chmodSync = function(path, mode) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.setAttributes_ofItemAtPath_error(\n    {\n      NSFilePosixPermissions: mode\n    },\n    path,\n    err\n  );\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n};\n\nmodule.exports.chown = NOT_IMPLEMENTED(\"chown\");\nmodule.exports.chownSync = NOT_IMPLEMENTED(\"chownSync\");\n\nmodule.exports.close = NOT_IMPLEMENTED(\"close\");\nmodule.exports.closeSync = NOT_IMPLEMENTED(\"closeSync\");\n\nmodule.exports.copyFile = NOT_IMPLEMENTED(\"copyFile\");\n\nmodule.exports.copyFileSync = function(path, dest, flags) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.copyItemAtPath_toPath_error(path, dest, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, false, err.value());\n  }\n};\n\nmodule.exports.createReadStream = NOT_IMPLEMENTED(\"createReadStream\");\nmodule.exports.createWriteStream = NOT_IMPLEMENTED(\"createWriteStream\");\n\nmodule.exports.exists = NOT_IMPLEMENTED(\"exists\");\n\nmodule.exports.existsSync = function(path) {\n  var fileManager = NSFileManager.defaultManager();\n  return Boolean(Number(fileManager.fileExistsAtPath(path)));\n};\n\nmodule.exports.fchmod = NOT_IMPLEMENTED(\"fchmod\");\nmodule.exports.fchmodSync = NOT_IMPLEMENTED(\"fchmodSync\");\nmodule.exports.fchown = NOT_IMPLEMENTED(\"fchown\");\nmodule.exports.fchownSync = NOT_IMPLEMENTED(\"fchownSync\");\nmodule.exports.fdatasync = NOT_IMPLEMENTED(\"fdatasync\");\nmodule.exports.fdatasyncSync = NOT_IMPLEMENTED(\"fdatasyncSync\");\nmodule.exports.fstat = NOT_IMPLEMENTED(\"fstat\");\nmodule.exports.fstatSync = NOT_IMPLEMENTED(\"fstatSync\");\nmodule.exports.fsync = NOT_IMPLEMENTED(\"fsync\");\nmodule.exports.fsyncSync = NOT_IMPLEMENTED(\"fsyncSync\");\nmodule.exports.ftruncate = NOT_IMPLEMENTED(\"ftruncate\");\nmodule.exports.ftruncateSync = NOT_IMPLEMENTED(\"ftruncateSync\");\nmodule.exports.futimes = NOT_IMPLEMENTED(\"futimes\");\nmodule.exports.futimesSync = NOT_IMPLEMENTED(\"futimesSync\");\n\nmodule.exports.lchmod = NOT_IMPLEMENTED(\"lchmod\");\nmodule.exports.lchmodSync = NOT_IMPLEMENTED(\"lchmodSync\");\nmodule.exports.lchown = NOT_IMPLEMENTED(\"lchown\");\nmodule.exports.lchownSync = NOT_IMPLEMENTED(\"lchownSync\");\n\nmodule.exports.link = NOT_IMPLEMENTED(\"link\");\n\nmodule.exports.linkSync = function(existingPath, newPath) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.linkItemAtPath_toPath_error(existingPath, newPath, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(existingPath, undefined, err.value());\n  }\n};\n\nmodule.exports.lstat = NOT_IMPLEMENTED(\"lstat\");\n\nmodule.exports.lstatSync = function(path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.attributesOfItemAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n\n  return parseStat(result);\n};\n\nmodule.exports.mkdir = NOT_IMPLEMENTED(\"mkdir\");\n\nmodule.exports.mkdirSync = function(path, options) {\n  var mode = 0o777;\n  var recursive = false;\n  if (options && options.mode) {\n    mode = options.mode;\n  }\n  if (options && options.recursive) {\n    recursive = options.recursive;\n  }\n  if (typeof options === \"number\") {\n    mode = options;\n  }\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.createDirectoryAtPath_withIntermediateDirectories_attributes_error(\n    path,\n    recursive,\n    {\n      NSFilePosixPermissions: mode\n    },\n    err\n  );\n\n  if (err.value() !== null) {\n    throw new Error(err.value());\n  }\n};\n\nmodule.exports.mkdtemp = NOT_IMPLEMENTED(\"mkdtemp\");\n\nmodule.exports.mkdtempSync = function(path) {\n  function makeid() {\n    var text = \"\";\n    var possible =\n      \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\n    for (var i = 0; i < 6; i++)\n      text += possible.charAt(Math.floor(Math.random() * possible.length));\n\n    return text;\n  }\n  var tempPath = path + makeid();\n  module.exports.mkdirSync(tempPath);\n  return tempPath;\n};\n\nmodule.exports.open = NOT_IMPLEMENTED(\"open\");\nmodule.exports.openSync = NOT_IMPLEMENTED(\"openSync\");\n\nmodule.exports.read = NOT_IMPLEMENTED(\"read\");\n\nmodule.exports.readdir = NOT_IMPLEMENTED(\"readdir\");\n\nmodule.exports.readdirSync = function(path, options) {\n  var encoding = encodingFromOptions(options, \"utf8\");\n  var fileManager = NSFileManager.defaultManager();\n  var paths = fileManager.subpathsAtPath(path);\n  var arr = [];\n  for (var i = 0; i < paths.length; i++) {\n    var pathName = paths[i];\n    arr.push(encoding === \"buffer\" ? Buffer.from(pathName) : String(pathName));\n  }\n  return arr;\n};\n\nmodule.exports.readFile = NOT_IMPLEMENTED(\"readFile\");\n\nmodule.exports.readFileSync = function(path, options) {\n  var encoding = encodingFromOptions(options, \"buffer\");\n  var fileManager = NSFileManager.defaultManager();\n  var data = fileManager.contentsAtPath(path);\n  if (!data) {\n    throw fsErrorForPath(path, false);\n  }\n\n  var buffer = Buffer.from(data);\n\n  if (encoding === \"buffer\") {\n    return buffer;\n  } else if (encoding === \"NSData\") {\n    return buffer.toNSData();\n  } else {\n    return buffer.toString(encoding);\n  }\n};\n\nmodule.exports.readlink = NOT_IMPLEMENTED(\"readlink\");\n\nmodule.exports.readlinkSync = function(path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.destinationOfSymbolicLinkAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n\n  return String(result);\n};\n\nmodule.exports.readSync = NOT_IMPLEMENTED(\"readSync\");\n\nmodule.exports.realpath = NOT_IMPLEMENTED(\"realpath\");\nmodule.exports.realpath.native = NOT_IMPLEMENTED(\"realpath.native\");\n\nmodule.exports.realpathSync = function(path) {\n  return String(NSString.stringWithString(path).stringByResolvingSymlinksInPath());\n};\n\nmodule.exports.realpathSync.native = NOT_IMPLEMENTED(\"realpathSync.native\");\n\nmodule.exports.rename = NOT_IMPLEMENTED(\"rename\");\n\nmodule.exports.renameSync = function(oldPath, newPath) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  fileManager.moveItemAtPath_toPath_error(oldPath, newPath, err);\n\n  var error = err.value();\n\n  if (error !== null) {\n    // if there is already a file, we need to overwrite it\n    if (\n      String(error.domain()) === \"NSCocoaErrorDomain\" &&\n      Number(error.code()) === 516\n    ) {\n      var err2 = MOPointer.alloc().init();\n      fileManager.replaceItemAtURL_withItemAtURL_backupItemName_options_resultingItemURL_error(\n        NSURL.fileURLWithPath(newPath),\n        NSURL.fileURLWithPath(oldPath),\n        null,\n        NSFileManagerItemReplacementUsingNewMetadataOnly,\n        null,\n        err2\n      );\n      if (err2.value() !== null) {\n        throw fsErrorForPath(oldPath, undefined, err2.value());\n      }\n    } else {\n      throw fsErrorForPath(oldPath, undefined, error);\n    }\n  }\n};\n\nmodule.exports.rmdir = NOT_IMPLEMENTED(\"rmdir\");\n\nmodule.exports.rmdirSync = function(path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var isDirectory = module.exports.lstatSync(path).isDirectory();\n  if (!isDirectory) {\n    throw fsError(\"ENOTDIR\", {\n      path: path,\n      syscall: \"rmdir\"\n    });\n  }\n  fileManager.removeItemAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, true, err.value(), \"rmdir\");\n  }\n};\n\nmodule.exports.stat = NOT_IMPLEMENTED(\"stat\");\n\n// the only difference with lstat is that we resolve symlinks\n//\n// > lstat() is identical to stat(), except that if pathname is a symbolic\n// > link, then it returns information about the link itself, not the file\n// > that it refers to.\n// http://man7.org/linux/man-pages/man2/lstat.2.html\nmodule.exports.statSync = function(path) {\n  return module.exports.lstatSync(module.exports.realpathSync(path));\n};\n\nmodule.exports.symlink = NOT_IMPLEMENTED(\"symlink\");\n\nmodule.exports.symlinkSync = function(target, path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.createSymbolicLinkAtPath_withDestinationPath_error(\n    path,\n    target,\n    err\n  );\n\n  if (err.value() !== null) {\n    throw new Error(err.value());\n  }\n};\n\nmodule.exports.truncate = NOT_IMPLEMENTED(\"truncate\");\n\nmodule.exports.truncateSync = function(path, len) {\n  var hFile = NSFileHandle.fileHandleForUpdatingAtPath(sFilePath);\n  hFile.truncateFileAtOffset(len || 0);\n  hFile.closeFile();\n};\n\nmodule.exports.unlink = NOT_IMPLEMENTED(\"unlink\");\n\nmodule.exports.unlinkSync = function(path) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var isDirectory = module.exports.lstatSync(path).isDirectory();\n  if (isDirectory) {\n    throw fsError(\"EPERM\", {\n      path: path,\n      syscall: \"unlink\"\n    });\n  }\n  var result = fileManager.removeItemAtPath_error(path, err);\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, false, err.value());\n  }\n};\n\nmodule.exports.unwatchFile = NOT_IMPLEMENTED(\"unwatchFile\");\n\nmodule.exports.utimes = NOT_IMPLEMENTED(\"utimes\");\n\nmodule.exports.utimesSync = function(path, aTime, mTime) {\n  var err = MOPointer.alloc().init();\n  var fileManager = NSFileManager.defaultManager();\n  var result = fileManager.setAttributes_ofItemAtPath_error(\n    {\n      NSFileModificationDate: aTime\n    },\n    path,\n    err\n  );\n\n  if (err.value() !== null) {\n    throw fsErrorForPath(path, undefined, err.value());\n  }\n};\n\nmodule.exports.watch = NOT_IMPLEMENTED(\"watch\");\nmodule.exports.watchFile = NOT_IMPLEMENTED(\"watchFile\");\n\nmodule.exports.write = NOT_IMPLEMENTED(\"write\");\n\nmodule.exports.writeFile = NOT_IMPLEMENTED(\"writeFile\");\n\nmodule.exports.writeFileSync = function(path, data, options) {\n  var encoding = encodingFromOptions(options, \"utf8\");\n\n  var nsdata = Buffer.from(\n    data,\n    encoding === \"NSData\" || encoding === \"buffer\" ? undefined : encoding\n  ).toNSData();\n\n  nsdata.writeToFile_atomically(path, true);\n};\n\nmodule.exports.writeSync = NOT_IMPLEMENTED(\"writeSync\");\n","module.exports.parseStat = function parseStat(result) {\n  return {\n    dev: String(result.NSFileDeviceIdentifier),\n    // ino: 48064969, The file system specific \"Inode\" number for the file.\n    mode: result.NSFileType | result.NSFilePosixPermissions,\n    nlink: Number(result.NSFileReferenceCount),\n    uid: String(result.NSFileOwnerAccountID),\n    gid: String(result.NSFileGroupOwnerAccountID),\n    // rdev: 0, A numeric device identifier if the file is considered \"special\".\n    size: Number(result.NSFileSize),\n    // blksize: 4096, The file system block size for i/o operations.\n    // blocks: 8, The number of blocks allocated for this file.\n    atimeMs:\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    mtimeMs:\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    ctimeMs:\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000,\n    birthtimeMs:\n      Number(result.NSFileCreationDate.timeIntervalSince1970()) * 1000,\n    atime: new Date(\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ), // the 0.5 comes from the node source. Not sure why it's added but in doubt...\n    mtime: new Date(\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ),\n    ctime: new Date(\n      Number(result.NSFileModificationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ),\n    birthtime: new Date(\n      Number(result.NSFileCreationDate.timeIntervalSince1970()) * 1000 + 0.5\n    ),\n    isBlockDevice: function() {\n      return result.NSFileType === NSFileTypeBlockSpecial;\n    },\n    isCharacterDevice: function() {\n      return result.NSFileType === NSFileTypeCharacterSpecial;\n    },\n    isDirectory: function() {\n      return result.NSFileType === NSFileTypeDirectory;\n    },\n    isFIFO: function() {\n      return false;\n    },\n    isFile: function() {\n      return result.NSFileType === NSFileTypeRegular;\n    },\n    isSocket: function() {\n      return result.NSFileType === NSFileTypeSocket;\n    },\n    isSymbolicLink: function() {\n      return result.NSFileType === NSFileTypeSymbolicLink;\n    }\n  };\n};\n\nvar ERRORS = {\n  EPERM: {\n    message: \"operation not permitted\",\n    errno: -1\n  },\n  ENOENT: {\n    message: \"no such file or directory\",\n    errno: -2\n  },\n  EACCES: {\n    message: \"permission denied\",\n    errno: -13\n  },\n  ENOTDIR: {\n    message: \"not a directory\",\n    errno: -20\n  },\n  EISDIR: {\n    message: \"illegal operation on a directory\",\n    errno: -21\n  }\n};\n\nfunction fsError(code, options) {\n  var error = new Error(\n    code +\n      \": \" +\n      ERRORS[code].message +\n      \", \" +\n      (options.syscall || \"\") +\n      (options.path ? \" '\" + options.path + \"'\" : \"\")\n  );\n\n  Object.keys(options).forEach(function(k) {\n    error[k] = options[k];\n  });\n\n  error.code = code;\n  error.errno = ERRORS[code].errno;\n\n  return error;\n}\n\nmodule.exports.fsError = fsError;\n\nmodule.exports.fsErrorForPath = function fsErrorForPath(\n  path,\n  shouldBeDir,\n  err,\n  syscall\n) {\n  var fileManager = NSFileManager.defaultManager();\n  var doesExist = fileManager.fileExistsAtPath(path);\n  if (!doesExist) {\n    return fsError(\"ENOENT\", {\n      path: path,\n      syscall: syscall || \"open\"\n    });\n  }\n  var isReadable = fileManager.isReadableFileAtPath(path);\n  if (!isReadable) {\n    return fsError(\"EACCES\", {\n      path: path,\n      syscall: syscall || \"open\"\n    });\n  }\n  if (typeof shouldBeDir !== \"undefined\") {\n    var isDirectory = module.exports.lstatSync(path).isDirectory();\n    if (isDirectory && !shouldBeDir) {\n      return fsError(\"EISDIR\", {\n        path: path,\n        syscall: syscall || \"read\"\n      });\n    } else if (!isDirectory && shouldBeDir) {\n      return fsError(\"ENOTDIR\", {\n        path: path,\n        syscall: syscall || \"read\"\n      });\n    }\n  }\n  return new Error(err || \"Unknown error while manipulating \" + path);\n};\n\nmodule.exports.encodingFromOptions = function encodingFromOptions(\n  options,\n  defaultValue\n) {\n  return options && options.encoding\n    ? String(options.encoding)\n    : options\n    ? String(options)\n    : defaultValue;\n};\n\nmodule.exports.NOT_IMPLEMENTED = function NOT_IMPLEMENTED(name) {\n  return function() {\n    throw new Error(\n      \"fs.\" +\n        name +\n        \" is not implemented yet. If you feel like implementing it, any contribution will be gladly accepted on https://github.com/skpm/fs\"\n    );\n  };\n};\n","/* from https://github.com/taylorhakes/promise-polyfill */\n\nfunction promiseFinally(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nfunction noop() {}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError(\"Promises must be constructed via new\");\n  if (typeof fn !== \"function\") throw new TypeError(\"not a function\");\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError(\"A promise cannot be resolved with itself.\");\n    if (\n      newValue &&\n      (typeof newValue === \"object\" || typeof newValue === \"function\")\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === \"function\") {\n        doResolve(then.bind(newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value, self);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === \"function\" ? onFulfilled : null;\n  this.onRejected = typeof onRejected === \"function\" ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) {\n          Promise._multipleResolvesFn(\"resolve\", self, value);\n          return;\n        }\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) {\n          Promise._multipleResolvesFn(\"reject\", self, reason);\n          return;\n        }\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) {\n      Promise._multipleResolvesFn(\"reject\", self, ex);\n      return;\n    }\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype[\"catch\"] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype[\"finally\"] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.all accepts an array\"));\n    }\n\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === \"object\" || typeof val === \"function\")) {\n          var then = val.then;\n          if (typeof then === \"function\") {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === \"object\" && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!Array.isArray(arr)) {\n      return reject(new TypeError(\"Promise.race accepts an array\"));\n    }\n\n    for (var i = 0, len = arr.length; i < len; i++) {\n      Promise.resolve(arr[i]).then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn = setImmediate;\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err, promise) {\n  if (\n    typeof process !== \"undefined\" &&\n    process.listenerCount &&\n    (process.listenerCount(\"unhandledRejection\") ||\n      process.listenerCount(\"uncaughtException\"))\n  ) {\n    process.emit(\"unhandledRejection\", err, promise);\n    process.emit(\"uncaughtException\", err, \"unhandledRejection\");\n  } else if (typeof console !== \"undefined\" && console) {\n    console.warn(\"Possible Unhandled Promise Rejection:\", err);\n  }\n};\n\nPromise._multipleResolvesFn = function _multipleResolvesFn(\n  type,\n  promise,\n  value\n) {\n  if (typeof process !== \"undefined\" && process.emit) {\n    process.emit(\"multipleResolves\", type, promise, value);\n  }\n};\n\nmodule.exports = Promise;\n","import define, {extend} from \"./define.js\";\n\nexport function Color() {}\n\nexport var darker = 0.7;\nexport var brighter = 1 / darker;\n\nvar reI = \"\\\\s*([+-]?\\\\d+)\\\\s*\",\n    reN = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*\",\n    reP = \"\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*\",\n    reHex = /^#([0-9a-f]{3,8})$/,\n    reRgbInteger = new RegExp(\"^rgb\\\\(\" + [reI, reI, reI] + \"\\\\)$\"),\n    reRgbPercent = new RegExp(\"^rgb\\\\(\" + [reP, reP, reP] + \"\\\\)$\"),\n    reRgbaInteger = new RegExp(\"^rgba\\\\(\" + [reI, reI, reI, reN] + \"\\\\)$\"),\n    reRgbaPercent = new RegExp(\"^rgba\\\\(\" + [reP, reP, reP, reN] + \"\\\\)$\"),\n    reHslPercent = new RegExp(\"^hsl\\\\(\" + [reN, reP, reP] + \"\\\\)$\"),\n    reHslaPercent = new RegExp(\"^hsla\\\\(\" + [reN, reP, reP, reN] + \"\\\\)$\");\n\nvar named = {\n  aliceblue: 0xf0f8ff,\n  antiquewhite: 0xfaebd7,\n  aqua: 0x00ffff,\n  aquamarine: 0x7fffd4,\n  azure: 0xf0ffff,\n  beige: 0xf5f5dc,\n  bisque: 0xffe4c4,\n  black: 0x000000,\n  blanchedalmond: 0xffebcd,\n  blue: 0x0000ff,\n  blueviolet: 0x8a2be2,\n  brown: 0xa52a2a,\n  burlywood: 0xdeb887,\n  cadetblue: 0x5f9ea0,\n  chartreuse: 0x7fff00,\n  chocolate: 0xd2691e,\n  coral: 0xff7f50,\n  cornflowerblue: 0x6495ed,\n  cornsilk: 0xfff8dc,\n  crimson: 0xdc143c,\n  cyan: 0x00ffff,\n  darkblue: 0x00008b,\n  darkcyan: 0x008b8b,\n  darkgoldenrod: 0xb8860b,\n  darkgray: 0xa9a9a9,\n  darkgreen: 0x006400,\n  darkgrey: 0xa9a9a9,\n  darkkhaki: 0xbdb76b,\n  darkmagenta: 0x8b008b,\n  darkolivegreen: 0x556b2f,\n  darkorange: 0xff8c00,\n  darkorchid: 0x9932cc,\n  darkred: 0x8b0000,\n  darksalmon: 0xe9967a,\n  darkseagreen: 0x8fbc8f,\n  darkslateblue: 0x483d8b,\n  darkslategray: 0x2f4f4f,\n  darkslategrey: 0x2f4f4f,\n  darkturquoise: 0x00ced1,\n  darkviolet: 0x9400d3,\n  deeppink: 0xff1493,\n  deepskyblue: 0x00bfff,\n  dimgray: 0x696969,\n  dimgrey: 0x696969,\n  dodgerblue: 0x1e90ff,\n  firebrick: 0xb22222,\n  floralwhite: 0xfffaf0,\n  forestgreen: 0x228b22,\n  fuchsia: 0xff00ff,\n  gainsboro: 0xdcdcdc,\n  ghostwhite: 0xf8f8ff,\n  gold: 0xffd700,\n  goldenrod: 0xdaa520,\n  gray: 0x808080,\n  green: 0x008000,\n  greenyellow: 0xadff2f,\n  grey: 0x808080,\n  honeydew: 0xf0fff0,\n  hotpink: 0xff69b4,\n  indianred: 0xcd5c5c,\n  indigo: 0x4b0082,\n  ivory: 0xfffff0,\n  khaki: 0xf0e68c,\n  lavender: 0xe6e6fa,\n  lavenderblush: 0xfff0f5,\n  lawngreen: 0x7cfc00,\n  lemonchiffon: 0xfffacd,\n  lightblue: 0xadd8e6,\n  lightcoral: 0xf08080,\n  lightcyan: 0xe0ffff,\n  lightgoldenrodyellow: 0xfafad2,\n  lightgray: 0xd3d3d3,\n  lightgreen: 0x90ee90,\n  lightgrey: 0xd3d3d3,\n  lightpink: 0xffb6c1,\n  lightsalmon: 0xffa07a,\n  lightseagreen: 0x20b2aa,\n  lightskyblue: 0x87cefa,\n  lightslategray: 0x778899,\n  lightslategrey: 0x778899,\n  lightsteelblue: 0xb0c4de,\n  lightyellow: 0xffffe0,\n  lime: 0x00ff00,\n  limegreen: 0x32cd32,\n  linen: 0xfaf0e6,\n  magenta: 0xff00ff,\n  maroon: 0x800000,\n  mediumaquamarine: 0x66cdaa,\n  mediumblue: 0x0000cd,\n  mediumorchid: 0xba55d3,\n  mediumpurple: 0x9370db,\n  mediumseagreen: 0x3cb371,\n  mediumslateblue: 0x7b68ee,\n  mediumspringgreen: 0x00fa9a,\n  mediumturquoise: 0x48d1cc,\n  mediumvioletred: 0xc71585,\n  midnightblue: 0x191970,\n  mintcream: 0xf5fffa,\n  mistyrose: 0xffe4e1,\n  moccasin: 0xffe4b5,\n  navajowhite: 0xffdead,\n  navy: 0x000080,\n  oldlace: 0xfdf5e6,\n  olive: 0x808000,\n  olivedrab: 0x6b8e23,\n  orange: 0xffa500,\n  orangered: 0xff4500,\n  orchid: 0xda70d6,\n  palegoldenrod: 0xeee8aa,\n  palegreen: 0x98fb98,\n  paleturquoise: 0xafeeee,\n  palevioletred: 0xdb7093,\n  papayawhip: 0xffefd5,\n  peachpuff: 0xffdab9,\n  peru: 0xcd853f,\n  pink: 0xffc0cb,\n  plum: 0xdda0dd,\n  powderblue: 0xb0e0e6,\n  purple: 0x800080,\n  rebeccapurple: 0x663399,\n  red: 0xff0000,\n  rosybrown: 0xbc8f8f,\n  royalblue: 0x4169e1,\n  saddlebrown: 0x8b4513,\n  salmon: 0xfa8072,\n  sandybrown: 0xf4a460,\n  seagreen: 0x2e8b57,\n  seashell: 0xfff5ee,\n  sienna: 0xa0522d,\n  silver: 0xc0c0c0,\n  skyblue: 0x87ceeb,\n  slateblue: 0x6a5acd,\n  slategray: 0x708090,\n  slategrey: 0x708090,\n  snow: 0xfffafa,\n  springgreen: 0x00ff7f,\n  steelblue: 0x4682b4,\n  tan: 0xd2b48c,\n  teal: 0x008080,\n  thistle: 0xd8bfd8,\n  tomato: 0xff6347,\n  turquoise: 0x40e0d0,\n  violet: 0xee82ee,\n  wheat: 0xf5deb3,\n  white: 0xffffff,\n  whitesmoke: 0xf5f5f5,\n  yellow: 0xffff00,\n  yellowgreen: 0x9acd32\n};\n\ndefine(Color, color, {\n  copy: function(channels) {\n    return Object.assign(new this.constructor, this, channels);\n  },\n  displayable: function() {\n    return this.rgb().displayable();\n  },\n  hex: color_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: color_formatHex,\n  formatHsl: color_formatHsl,\n  formatRgb: color_formatRgb,\n  toString: color_formatRgb\n});\n\nfunction color_formatHex() {\n  return this.rgb().formatHex();\n}\n\nfunction color_formatHsl() {\n  return hslConvert(this).formatHsl();\n}\n\nfunction color_formatRgb() {\n  return this.rgb().formatRgb();\n}\n\nexport default function color(format) {\n  var m, l;\n  format = (format + \"\").trim().toLowerCase();\n  return (m = reHex.exec(format)) ? (l = m[1].length, m = parseInt(m[1], 16), l === 6 ? rgbn(m) // #ff0000\n      : l === 3 ? new Rgb((m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), ((m & 0xf) << 4) | (m & 0xf), 1) // #f00\n      : l === 8 ? new Rgb(m >> 24 & 0xff, m >> 16 & 0xff, m >> 8 & 0xff, (m & 0xff) / 0xff) // #ff000000\n      : l === 4 ? new Rgb((m >> 12 & 0xf) | (m >> 8 & 0xf0), (m >> 8 & 0xf) | (m >> 4 & 0xf0), (m >> 4 & 0xf) | (m & 0xf0), (((m & 0xf) << 4) | (m & 0xf)) / 0xff) // #f000\n      : null) // invalid hex\n      : (m = reRgbInteger.exec(format)) ? new Rgb(m[1], m[2], m[3], 1) // rgb(255, 0, 0)\n      : (m = reRgbPercent.exec(format)) ? new Rgb(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, 1) // rgb(100%, 0%, 0%)\n      : (m = reRgbaInteger.exec(format)) ? rgba(m[1], m[2], m[3], m[4]) // rgba(255, 0, 0, 1)\n      : (m = reRgbaPercent.exec(format)) ? rgba(m[1] * 255 / 100, m[2] * 255 / 100, m[3] * 255 / 100, m[4]) // rgb(100%, 0%, 0%, 1)\n      : (m = reHslPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, 1) // hsl(120, 50%, 50%)\n      : (m = reHslaPercent.exec(format)) ? hsla(m[1], m[2] / 100, m[3] / 100, m[4]) // hsla(120, 50%, 50%, 1)\n      : named.hasOwnProperty(format) ? rgbn(named[format]) // eslint-disable-line no-prototype-builtins\n      : format === \"transparent\" ? new Rgb(NaN, NaN, NaN, 0)\n      : null;\n}\n\nfunction rgbn(n) {\n  return new Rgb(n >> 16 & 0xff, n >> 8 & 0xff, n & 0xff, 1);\n}\n\nfunction rgba(r, g, b, a) {\n  if (a <= 0) r = g = b = NaN;\n  return new Rgb(r, g, b, a);\n}\n\nexport function rgbConvert(o) {\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Rgb;\n  o = o.rgb();\n  return new Rgb(o.r, o.g, o.b, o.opacity);\n}\n\nexport function rgb(r, g, b, opacity) {\n  return arguments.length === 1 ? rgbConvert(r) : new Rgb(r, g, b, opacity == null ? 1 : opacity);\n}\n\nexport function Rgb(r, g, b, opacity) {\n  this.r = +r;\n  this.g = +g;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Rgb, rgb, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Rgb(this.r * k, this.g * k, this.b * k, this.opacity);\n  },\n  rgb: function() {\n    return this;\n  },\n  displayable: function() {\n    return (-0.5 <= this.r && this.r < 255.5)\n        && (-0.5 <= this.g && this.g < 255.5)\n        && (-0.5 <= this.b && this.b < 255.5)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  hex: rgb_formatHex, // Deprecated! Use color.formatHex.\n  formatHex: rgb_formatHex,\n  formatRgb: rgb_formatRgb,\n  toString: rgb_formatRgb\n}));\n\nfunction rgb_formatHex() {\n  return \"#\" + hex(this.r) + hex(this.g) + hex(this.b);\n}\n\nfunction rgb_formatRgb() {\n  var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n  return (a === 1 ? \"rgb(\" : \"rgba(\")\n      + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + \", \"\n      + Math.max(0, Math.min(255, Math.round(this.b) || 0))\n      + (a === 1 ? \")\" : \", \" + a + \")\");\n}\n\nfunction hex(value) {\n  value = Math.max(0, Math.min(255, Math.round(value) || 0));\n  return (value < 16 ? \"0\" : \"\") + value.toString(16);\n}\n\nfunction hsla(h, s, l, a) {\n  if (a <= 0) h = s = l = NaN;\n  else if (l <= 0 || l >= 1) h = s = NaN;\n  else if (s <= 0) h = NaN;\n  return new Hsl(h, s, l, a);\n}\n\nexport function hslConvert(o) {\n  if (o instanceof Hsl) return new Hsl(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Color)) o = color(o);\n  if (!o) return new Hsl;\n  if (o instanceof Hsl) return o;\n  o = o.rgb();\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      h = NaN,\n      s = max - min,\n      l = (max + min) / 2;\n  if (s) {\n    if (r === max) h = (g - b) / s + (g < b) * 6;\n    else if (g === max) h = (b - r) / s + 2;\n    else h = (r - g) / s + 4;\n    s /= l < 0.5 ? max + min : 2 - max - min;\n    h *= 60;\n  } else {\n    s = l > 0 && l < 1 ? 0 : h;\n  }\n  return new Hsl(h, s, l, o.opacity);\n}\n\nexport function hsl(h, s, l, opacity) {\n  return arguments.length === 1 ? hslConvert(h) : new Hsl(h, s, l, opacity == null ? 1 : opacity);\n}\n\nfunction Hsl(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Hsl, hsl, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Hsl(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = this.h % 360 + (this.h < 0) * 360,\n        s = isNaN(h) || isNaN(this.s) ? 0 : this.s,\n        l = this.l,\n        m2 = l + (l < 0.5 ? l : 1 - l) * s,\n        m1 = 2 * l - m2;\n    return new Rgb(\n      hsl2rgb(h >= 240 ? h - 240 : h + 120, m1, m2),\n      hsl2rgb(h, m1, m2),\n      hsl2rgb(h < 120 ? h + 240 : h - 120, m1, m2),\n      this.opacity\n    );\n  },\n  displayable: function() {\n    return (0 <= this.s && this.s <= 1 || isNaN(this.s))\n        && (0 <= this.l && this.l <= 1)\n        && (0 <= this.opacity && this.opacity <= 1);\n  },\n  formatHsl: function() {\n    var a = this.opacity; a = isNaN(a) ? 1 : Math.max(0, Math.min(1, a));\n    return (a === 1 ? \"hsl(\" : \"hsla(\")\n        + (this.h || 0) + \", \"\n        + (this.s || 0) * 100 + \"%, \"\n        + (this.l || 0) * 100 + \"%\"\n        + (a === 1 ? \")\" : \", \" + a + \")\");\n  }\n}));\n\n/* From FvD 13.37, CSS Color Module Level 3 */\nfunction hsl2rgb(h, m1, m2) {\n  return (h < 60 ? m1 + (m2 - m1) * h / 60\n      : h < 180 ? m2\n      : h < 240 ? m1 + (m2 - m1) * (240 - h) / 60\n      : m1) * 255;\n}\n","import define, {extend} from \"./define.js\";\nimport {Color, rgbConvert, Rgb, darker, brighter} from \"./color.js\";\nimport {deg2rad, rad2deg} from \"./math.js\";\n\nvar A = -0.14861,\n    B = +1.78277,\n    C = -0.29227,\n    D = -0.90649,\n    E = +1.97294,\n    ED = E * D,\n    EB = E * B,\n    BC_DA = B * C - D * A;\n\nfunction cubehelixConvert(o) {\n  if (o instanceof Cubehelix) return new Cubehelix(o.h, o.s, o.l, o.opacity);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = o.r / 255,\n      g = o.g / 255,\n      b = o.b / 255,\n      l = (BC_DA * b + ED * r - EB * g) / (BC_DA + ED - EB),\n      bl = b - l,\n      k = (E * (g - l) - C * bl) / D,\n      s = Math.sqrt(k * k + bl * bl) / (E * l * (1 - l)), // NaN if l=0 or l=1\n      h = s ? Math.atan2(k, bl) * rad2deg - 120 : NaN;\n  return new Cubehelix(h < 0 ? h + 360 : h, s, l, o.opacity);\n}\n\nexport default function cubehelix(h, s, l, opacity) {\n  return arguments.length === 1 ? cubehelixConvert(h) : new Cubehelix(h, s, l, opacity == null ? 1 : opacity);\n}\n\nexport function Cubehelix(h, s, l, opacity) {\n  this.h = +h;\n  this.s = +s;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\ndefine(Cubehelix, cubehelix, extend(Color, {\n  brighter: function(k) {\n    k = k == null ? brighter : Math.pow(brighter, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  darker: function(k) {\n    k = k == null ? darker : Math.pow(darker, k);\n    return new Cubehelix(this.h, this.s, this.l * k, this.opacity);\n  },\n  rgb: function() {\n    var h = isNaN(this.h) ? 0 : (this.h + 120) * deg2rad,\n        l = +this.l,\n        a = isNaN(this.s) ? 0 : this.s * l * (1 - l),\n        cosh = Math.cos(h),\n        sinh = Math.sin(h);\n    return new Rgb(\n      255 * (l + a * (A * cosh + B * sinh)),\n      255 * (l + a * (C * cosh + D * sinh)),\n      255 * (l + a * (E * cosh)),\n      this.opacity\n    );\n  }\n}));\n","export default function(constructor, factory, prototype) {\n  constructor.prototype = factory.prototype = prototype;\n  prototype.constructor = constructor;\n}\n\nexport function extend(parent, definition) {\n  var prototype = Object.create(parent.prototype);\n  for (var key in definition) prototype[key] = definition[key];\n  return prototype;\n}\n","export {default as color, rgb, hsl} from \"./color.js\";\nexport {default as lab, hcl, lch, gray} from \"./lab.js\";\nexport {default as cubehelix} from \"./cubehelix.js\";\n","import define, {extend} from \"./define.js\";\nimport {Color, rgbConvert, Rgb} from \"./color.js\";\nimport {deg2rad, rad2deg} from \"./math.js\";\n\n// https://observablehq.com/@mbostock/lab-and-rgb\nvar K = 18,\n    Xn = 0.96422,\n    Yn = 1,\n    Zn = 0.82521,\n    t0 = 4 / 29,\n    t1 = 6 / 29,\n    t2 = 3 * t1 * t1,\n    t3 = t1 * t1 * t1;\n\nfunction labConvert(o) {\n  if (o instanceof Lab) return new Lab(o.l, o.a, o.b, o.opacity);\n  if (o instanceof Hcl) return hcl2lab(o);\n  if (!(o instanceof Rgb)) o = rgbConvert(o);\n  var r = rgb2lrgb(o.r),\n      g = rgb2lrgb(o.g),\n      b = rgb2lrgb(o.b),\n      y = xyz2lab((0.2225045 * r + 0.7168786 * g + 0.0606169 * b) / Yn), x, z;\n  if (r === g && g === b) x = z = y; else {\n    x = xyz2lab((0.4360747 * r + 0.3850649 * g + 0.1430804 * b) / Xn);\n    z = xyz2lab((0.0139322 * r + 0.0971045 * g + 0.7141733 * b) / Zn);\n  }\n  return new Lab(116 * y - 16, 500 * (x - y), 200 * (y - z), o.opacity);\n}\n\nexport function gray(l, opacity) {\n  return new Lab(l, 0, 0, opacity == null ? 1 : opacity);\n}\n\nexport default function lab(l, a, b, opacity) {\n  return arguments.length === 1 ? labConvert(l) : new Lab(l, a, b, opacity == null ? 1 : opacity);\n}\n\nexport function Lab(l, a, b, opacity) {\n  this.l = +l;\n  this.a = +a;\n  this.b = +b;\n  this.opacity = +opacity;\n}\n\ndefine(Lab, lab, extend(Color, {\n  brighter: function(k) {\n    return new Lab(this.l + K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  darker: function(k) {\n    return new Lab(this.l - K * (k == null ? 1 : k), this.a, this.b, this.opacity);\n  },\n  rgb: function() {\n    var y = (this.l + 16) / 116,\n        x = isNaN(this.a) ? y : y + this.a / 500,\n        z = isNaN(this.b) ? y : y - this.b / 200;\n    x = Xn * lab2xyz(x);\n    y = Yn * lab2xyz(y);\n    z = Zn * lab2xyz(z);\n    return new Rgb(\n      lrgb2rgb( 3.1338561 * x - 1.6168667 * y - 0.4906146 * z),\n      lrgb2rgb(-0.9787684 * x + 1.9161415 * y + 0.0334540 * z),\n      lrgb2rgb( 0.0719453 * x - 0.2289914 * y + 1.4052427 * z),\n      this.opacity\n    );\n  }\n}));\n\nfunction xyz2lab(t) {\n  return t > t3 ? Math.pow(t, 1 / 3) : t / t2 + t0;\n}\n\nfunction lab2xyz(t) {\n  return t > t1 ? t * t * t : t2 * (t - t0);\n}\n\nfunction lrgb2rgb(x) {\n  return 255 * (x <= 0.0031308 ? 12.92 * x : 1.055 * Math.pow(x, 1 / 2.4) - 0.055);\n}\n\nfunction rgb2lrgb(x) {\n  return (x /= 255) <= 0.04045 ? x / 12.92 : Math.pow((x + 0.055) / 1.055, 2.4);\n}\n\nfunction hclConvert(o) {\n  if (o instanceof Hcl) return new Hcl(o.h, o.c, o.l, o.opacity);\n  if (!(o instanceof Lab)) o = labConvert(o);\n  if (o.a === 0 && o.b === 0) return new Hcl(NaN, 0 < o.l && o.l < 100 ? 0 : NaN, o.l, o.opacity);\n  var h = Math.atan2(o.b, o.a) * rad2deg;\n  return new Hcl(h < 0 ? h + 360 : h, Math.sqrt(o.a * o.a + o.b * o.b), o.l, o.opacity);\n}\n\nexport function lch(l, c, h, opacity) {\n  return arguments.length === 1 ? hclConvert(l) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function hcl(h, c, l, opacity) {\n  return arguments.length === 1 ? hclConvert(h) : new Hcl(h, c, l, opacity == null ? 1 : opacity);\n}\n\nexport function Hcl(h, c, l, opacity) {\n  this.h = +h;\n  this.c = +c;\n  this.l = +l;\n  this.opacity = +opacity;\n}\n\nfunction hcl2lab(o) {\n  if (isNaN(o.h)) return new Lab(o.l, 0, 0, o.opacity);\n  var h = o.h * deg2rad;\n  return new Lab(o.l, Math.cos(h) * o.c, Math.sin(h) * o.c, o.opacity);\n}\n\ndefine(Hcl, hcl, extend(Color, {\n  brighter: function(k) {\n    return new Hcl(this.h, this.c, this.l + K * (k == null ? 1 : k), this.opacity);\n  },\n  darker: function(k) {\n    return new Hcl(this.h, this.c, this.l - K * (k == null ? 1 : k), this.opacity);\n  },\n  rgb: function() {\n    return hcl2lab(this).rgb();\n  }\n}));\n","export var deg2rad = Math.PI / 180;\nexport var rad2deg = 180 / Math.PI;\n","'use strict';\r\n\r\n/**\r\n * @class dE00\r\n * @classdesc\r\n * The CIE2000 color difference algorithm.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIEDE2000\r\n * @constructs dE00\r\n * @memberOf DeltaE\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @property {object} weights The weights configuration object.\r\n * @property {number} weights.lightness A weight factor to apply to lightness.\r\n * @property {number} weights.chroma A weight factor to apply to chroma.\r\n * @property {number} weights.hue A weight factor to apply to hue.\r\n * @example\r\n * var deltaE = new dE00(\r\n *     {L:50, A:50, B:50},\r\n *     {L:100, A:50, B:50},\r\n * );\r\n * console.log(deltaE.getDeltaE());\r\n */\r\nfunction dE00(x1, x2, weights) {\r\n    var sqrt = Math.sqrt;\r\n    var pow = Math.pow;\r\n    \r\n    this.x1 = x1;\r\n    this.x2 = x2;\r\n    \r\n    this.weights = weights || {};\r\n    this.ksubL = this.weights.lightness || 1;\r\n    this.ksubC = this.weights.chroma || 1;\r\n    this.ksubH = this.weights.hue || 1;\r\n    \r\n    // Delta L Prime\r\n    this.deltaLPrime = x2.L - x1.L;\r\n    \r\n    // L Bar\r\n    this.LBar = (x1.L + x2.L) / 2;\r\n    \r\n    // C1 & C2\r\n    this.C1 = sqrt(pow(x1.A, 2) + pow(x1.B, 2));\r\n    this.C2 = sqrt(pow(x2.A, 2) + pow(x2.B, 2));\r\n    \r\n    // C Bar\r\n    this.CBar = (this.C1 + this.C2) / 2;\r\n    \r\n    // A Prime 1\r\n    this.aPrime1 = x1.A +\r\n        (x1.A / 2) *\r\n        (1 - sqrt(\r\n            pow(this.CBar, 7) /\r\n            (pow(this.CBar, 7) + pow(25, 7))\r\n        ));\r\n\r\n    // A Prime 2\r\n    this.aPrime2 = x2.A +\r\n        (x2.A / 2) *\r\n        (1 - sqrt(\r\n            pow(this.CBar, 7) /\r\n            (pow(this.CBar, 7) + pow(25, 7))\r\n        ));\r\n\r\n    // C Prime 1\r\n    this.CPrime1 = sqrt(\r\n        pow(this.aPrime1, 2) +\r\n        pow(x1.B, 2)\r\n    );\r\n    \r\n    // C Prime 2\r\n    this.CPrime2 = sqrt(\r\n        pow(this.aPrime2, 2) +\r\n        pow(x2.B, 2)\r\n    );\r\n    \r\n    // C Bar Prime\r\n    this.CBarPrime = (this.CPrime1 + this.CPrime2) / 2;\r\n    \r\n    // Delta C Prime\r\n    this.deltaCPrime = this.CPrime2 - this.CPrime1;\r\n    \r\n    // S sub L\r\n    this.SsubL = 1 + (\r\n        (0.015 * pow(this.LBar - 50, 2)) /\r\n        sqrt(20 + pow(this.LBar - 50, 2))\r\n    );\r\n    \r\n    // S sub C\r\n    this.SsubC = 1 + 0.045 * this.CBarPrime;\r\n    \r\n    /**\r\n     * Properties set in getDeltaE method, for access to convenience functions\r\n     */\r\n    // h Prime 1\r\n    this.hPrime1 = 0;\r\n    \r\n    // h Prime 2\r\n    this.hPrime2 = 0;\r\n    \r\n    // Delta h Prime\r\n    this.deltahPrime = 0;\r\n    \r\n    // Delta H Prime\r\n    this.deltaHPrime = 0;\r\n    \r\n    // H Bar Prime\r\n    this.HBarPrime = 0;\r\n    \r\n    // T\r\n    this.T = 0;\r\n    \r\n    // S sub H\r\n    this.SsubH = 0;\r\n    \r\n    // R sub T\r\n    this.RsubT = 0;\r\n}\r\n\r\n/**\r\n * Returns the deltaE value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.getDeltaE = function() {\r\n    var sqrt = Math.sqrt;\r\n    var sin = Math.sin;\r\n    var pow = Math.pow;\r\n    \r\n    // h Prime 1\r\n    this.hPrime1 = this.gethPrime1();\r\n    \r\n    // h Prime 2\r\n    this.hPrime2 = this.gethPrime2();\r\n    \r\n    // Delta h Prime\r\n    this.deltahPrime = this.getDeltahPrime();\r\n    \r\n    // Delta H Prime\r\n    this.deltaHPrime = 2 * sqrt(this.CPrime1 * this.CPrime2) * sin(this.degreesToRadians(this.deltahPrime) / 2);\r\n    \r\n    // H Bar Prime\r\n    this.HBarPrime = this.getHBarPrime();\r\n    \r\n    // T\r\n    this.T = this.getT();\r\n    \r\n    // S sub H\r\n    this.SsubH = 1 + 0.015 * this.CBarPrime * this.T;\r\n    \r\n    // R sub T\r\n    this.RsubT = this.getRsubT();\r\n    \r\n    // Put it all together!\r\n    var lightness = this.deltaLPrime / (this.ksubL * this.SsubL);\r\n    var chroma = this.deltaCPrime / (this.ksubC * this.SsubC);\r\n    var hue = this.deltaHPrime / (this.ksubH * this.SsubH);\r\n   \r\n    return sqrt(\r\n        pow(lightness, 2) +\r\n        pow(chroma, 2) +\r\n        pow(hue, 2) +\r\n        this.RsubT * chroma * hue\r\n    );\r\n};\r\n\r\n/**\r\n * Returns the RT variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.getRsubT = function() {\r\n    var sin = Math.sin;\r\n    var sqrt = Math.sqrt;\r\n    var pow = Math.pow;\r\n    var exp = Math.exp;\r\n    \r\n    return -2 *\r\n        sqrt(\r\n            pow(this.CBarPrime, 7) /\r\n            (pow(this.CBarPrime, 7) + pow(25, 7))\r\n        ) *\r\n        sin(this.degreesToRadians(\r\n            60 *\r\n            exp(\r\n                -(\r\n                    pow(\r\n                        (this.HBarPrime - 275) / 25, 2\r\n                    )\r\n                )\r\n            )\r\n        ));\r\n};\r\n\r\n/**\r\n * Returns the T variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.getT = function() {\r\n    var cos = Math.cos;\r\n    \r\n    return 1 -\r\n        0.17 * cos(this.degreesToRadians(this.HBarPrime - 30)) +\r\n        0.24 * cos(this.degreesToRadians(2 * this.HBarPrime)) +\r\n        0.32 * cos(this.degreesToRadians(3 * this.HBarPrime + 6)) -\r\n        0.20 * cos(this.degreesToRadians(4 * this.HBarPrime - 63));\r\n};\r\n\r\n/**\r\n * Returns the H Bar Prime variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.getHBarPrime= function() {\r\n    var abs = Math.abs;\r\n    \r\n    if (abs(this.hPrime1 - this.hPrime2) > 180) {\r\n        return (this.hPrime1 + this.hPrime2 + 360) / 2\r\n    }\r\n    \r\n    return (this.hPrime1 + this.hPrime2) / 2\r\n};\r\n\r\n/**\r\n * Returns the Delta h Prime variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.getDeltahPrime = function() {\r\n    var abs = Math.abs;\r\n    \r\n    // When either C1 or C2 is zero, then h is irrelevant and may be set to\r\n    // zero.\r\n    if (0 === this.C1 || 0 === this.C2) {\r\n        return 0;\r\n    }\r\n    \r\n    if (abs(this.hPrime1 - this.hPrime2) <= 180) {\r\n        return this.hPrime2 - this.hPrime1;\r\n    }\r\n    \r\n    if (this.hPrime2 <= this.hPrime1) {\r\n        return this.hPrime2 - this.hPrime1 + 360;\r\n    } else {\r\n        return this.hPrime2 - this.hPrime1 - 360;\r\n    }\r\n};\r\n\r\n/**\r\n * Returns the h Prime 1 variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.gethPrime1 = function() {\r\n    return this._gethPrimeFn(this.x1.B, this.aPrime1);\r\n};\r\n\r\n/**\r\n * Returns the h Prime 2 variable calculation.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.gethPrime2 = function() {\r\n    return this._gethPrimeFn(this.x2.B, this.aPrime2);\r\n};\r\n\r\n/**\r\n * A helper function to calculate the h Prime 1 and h Prime 2 values.\r\n * @method\r\n * @private\r\n * @returns {number}\r\n */\r\ndE00.prototype._gethPrimeFn = function(x, y) {\r\n    var hueAngle;\r\n    \r\n    if (x === 0 && y === 0) {\r\n        return 0;\r\n    }\r\n    \r\n    hueAngle = this.radiansToDegrees(Math.atan2(x, y));\r\n    \r\n    if (hueAngle >= 0) {\r\n        return hueAngle;\r\n    } else {\r\n        return hueAngle + 360;\r\n    }\r\n};\r\n\r\n/**\r\n * Gives the radian equivalent of a specified degree angle.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.radiansToDegrees = function(radians) {\r\n    return radians * (180 / Math.PI);\r\n};\r\n\r\n/**\r\n * Gives the degree equivalent of a specified radian.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE00.prototype.degreesToRadians = function(degrees) {\r\n    return degrees * (Math.PI / 180);\r\n};\r\n\r\nmodule.exports = dE00;","'use strict';\r\n\r\n/**\r\n * @class dE76\r\n * @classdesc\r\n * The CIE76 color difference algorithm: a simple euclidean distance calculation.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIE76\r\n * @constructs dE76\r\n * @memberOf DeltaE\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @example\r\n * var deltaE = new dE76(\r\n *     {L:50, A:50, B:50},\r\n *     {L:100, A:50, B:50},\r\n * );\r\n * console.log(deltaE.getDeltaE());\r\n */\r\nfunction dE76(x1, x2) {\r\n    this.x1 = x1;\r\n    this.x2 = x2;\r\n}\r\n\r\n/**\r\n * Returns the dE76 value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE76.prototype.getDeltaE = function() {\r\n    var x1 = this.x1;\r\n    var x2 = this.x2;\r\n    \r\n    return Math.sqrt(\r\n        Math.pow(x2.L - x1.L, 2) +\r\n        Math.pow(x2.A - x1.A, 2) +\r\n        Math.pow(x2.B - x1.B, 2)\r\n    );\r\n};\r\n\r\nmodule.exports = dE76;","'use strict';\r\n\r\n/**\r\n * @class dE94\r\n * @classdesc\r\n * The CIE94 algorithm: an iteration of the CIE76 algorithm.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIE94\r\n * @constructs dE94\r\n * @memberOf DeltaE\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @property {object} weights The weights configuration object.\r\n * @property {number} weights.lightness A weight factor to apply to lightness.\r\n * @property {number} weights.chroma A weight factor to apply to chroma.\r\n * @property {number} weights.hue A weight factor to apply to hue.\r\n * @example\r\n * var deltaE = new dE94(\r\n *     {L:50, A:50, B:50},\r\n *     {L:100, A:50, B:50},\r\n * );\r\n * console.log(deltaE.getDeltaE());\r\n */\r\nfunction dE94(x1, x2, weights) {\r\n    this.x1 = x1;\r\n    this.x2 = x2;\r\n    \r\n    this.weights = weights || {};\r\n    this.weights.lightness = this.weights.lightness || 1;\r\n    this.weights.chroma = this.weights.chroma || 1;\r\n    this.weights.hue = this.weights.hue || 1;\r\n    \r\n    if (1 === this.weights.lightness) {\r\n        this.weights.K1 = 0.045;\r\n        this.weights.K2 = 0.015;\r\n    } else {\r\n        this.weights.K1 = 0.048;\r\n        this.weights.K2 = 0.014;\r\n    }\r\n}\r\n\r\n/**\r\n * Returns the dE94 value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE94.prototype.getDeltaE = function() {\r\n    var x1 = this.x1;\r\n    var x2 = this.x2;\r\n    var sqrt = Math.sqrt;\r\n    var pow = Math.pow;\r\n    \r\n    return sqrt(\r\n        pow(this.calculateL(x1, x2), 2) +\r\n        pow(this.calculateA(x1, x2), 2) +\r\n        pow(this.calculateB(x1, x2), 2)\r\n    );\r\n};\r\n\r\n/**\r\n * Calculates the lightness value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE94.prototype.calculateL = function(x1, x2) {\r\n    return (x1.L - x2.L) / this.weights.lightness;\r\n};\r\n\r\n/**\r\n * Calculates the chroma value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE94.prototype.calculateA = function(x1, x2) {\r\n    var sqrt = Math.sqrt;\r\n    var pow = Math.pow;\r\n    \r\n    //top\r\n    var c1 = sqrt(pow(x1.A, 2) + pow(x1.B, 2));\r\n    var c2 = sqrt(pow(x2.A, 2) + pow(x2.B, 2));\r\n    var cab = c1 - c2;\r\n    \r\n    // bottom\r\n    var sc = 1 + (this.weights.K1 * c1);\r\n    \r\n    return cab / (this.weights.chroma * sc);\r\n};\r\n\r\n/**\r\n * Calculates the hue value.\r\n * @method\r\n * @returns {number}\r\n */\r\ndE94.prototype.calculateB = function(x1, x2) {\r\n    var sqrt = Math.sqrt;\r\n    var pow = Math.pow;\r\n    \r\n    // cab\r\n    var c1 = sqrt(pow(x1.A, 2) + pow(x1.B, 2));\r\n    var c2 = sqrt(pow(x2.A, 2) + pow(x2.B, 2));\r\n    var cab = c1 - c2;\r\n    \r\n    // top\r\n    var a = x1.A - x2.A;\r\n    var b = x1.B - x2.B;\r\n    var hab = sqrt(\r\n        pow(a, 2) +\r\n        pow(b, 2) -\r\n        pow(cab, 2)\r\n    );\r\n    \r\n    // bottom\r\n    var c1 = sqrt(pow(x1.A, 2) + pow(x1.B, 2));\r\n    var sh = 1 + (this.weights.K2 * c1);\r\n    \r\n    return hab / sh;\r\n};\r\n\r\nmodule.exports = dE94;","'use strict';\r\n\r\n/**\r\n * @class DeltaE\r\n * @classdesc\r\n * A package of dE76, dE94, and dE00 algorithms.\r\n * @constructs DeltaE\r\n * @example\r\n * var DeltaE = new DeltaE();\r\n * var labColor1 = {L: 50, A: 50, B: 50};\r\n * var labColor2 = {L: 20, A: 20, B: 20};\r\n * \r\n * DeltaE.getDeltaE94(labColor1, labColor2);\r\n */\r\nvar dE76 = require('./dE76');\r\nvar dE94 = require('./dE94');\r\nvar dE00 = require('./dE00');\r\n\r\nfunction DeltaE() {}\r\n\r\n/**\r\n * The CIE76 color difference algorithm: a simple euclidean distance calculation.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIE76\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @returns {number} The computed dE76 value.\r\n * @example\r\n * var labColor1 = {L: 50, A: 50, B: 50};\r\n * var labColor2 = {L: 20, A: 20, B: 20};\r\n * \r\n * DeltaE.getDeltaE76(labColor1, labColor2);\r\n */\r\nDeltaE.prototype.getDeltaE76 = function(lab1, lab2) {\r\n    var deltaE = new dE76(lab1, lab2);\r\n    return deltaE.getDeltaE();\r\n};\r\n\r\n/**\r\n * The CIE94 algorithm: an iteration of the CIE76 algorithm.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIE94\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @property {object} weights The weights configuration object.\r\n * @property {number} weights.lightness A weight factor to apply to lightness.\r\n * @property {number} weights.chroma A weight factor to apply to chroma.\r\n * @property {number} weights.hue A weight factor to apply to hue.\r\n * @returns {number} The computed dE94 value.\r\n * @example\r\n * var labColor1 = {L: 50, A: 50, B: 50};\r\n * var labColor2 = {L: 20, A: 20, B: 20};\r\n * \r\n * DeltaE.getDeltaE94(labColor1, labColor2);\r\n */\r\nDeltaE.prototype.getDeltaE94 = function(lab1, lab2) {\r\n    var deltaE = new dE94(lab1, lab2);\r\n    return deltaE.getDeltaE();\r\n};\r\n\r\n/**\r\n * The CIE2000 color difference algorithm.\r\n * http://en.wikipedia.org/wiki/Color_difference#CIEDE2000\r\n * @property {object} x1 The LAB color configuration object.\r\n * @property {number} x1.L The lightness value, on scale of 0-100.\r\n * @property {number} x1.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x1.B The hue value, on scale of -128 to 128.\r\n * @property {object} x2 The LAB color configuration object.\r\n * @property {number} x2.L The lightness value, on scale of 0-100.\r\n * @property {number} x2.A The chroma value, on scale of -128 to 128.\r\n * @property {number} x2.B The hue value, on scale of -128 to 128.\r\n * @property {object} weights The weights configuration object.\r\n * @property {number} weights.lightness A weight factor to apply to lightness.\r\n * @property {number} weights.chroma A weight factor to apply to chroma.\r\n * @property {number} weights.hue A weight factor to apply to hue.\r\n * @returns {number} The computed dE00 value.\r\n * @example\r\n * var labColor1 = {L: 50, A: 50, B: 50};\r\n * var labColor2 = {L: 20, A: 20, B: 20};\r\n * \r\n * DeltaE.getDeltaE00(labColor1, labColor2);\r\n */\r\nDeltaE.prototype.getDeltaE00 = function(lab1, lab2) {\r\n    var deltaE = new dE00(lab1, lab2);\r\n    return deltaE.getDeltaE();\r\n};\r\n\r\nmodule.exports = new DeltaE;","/* globals MOClassDescription, NSObject, NSSelectorFromString, NSClassFromString, MOPropertyDescription */\n\nmodule.exports = function MochaDelegate(definition, superclass) {\n  var uniqueClassName =\n    'MochaJSDelegate_DynamicClass_' + NSUUID.UUID().UUIDString()\n\n  var delegateClassDesc = MOClassDescription.allocateDescriptionForClassWithName_superclass_(\n    uniqueClassName,\n    superclass || NSObject\n  )\n\n  // Storage\n  var handlers = {}\n  var ivars = {}\n\n  // Define an instance method\n  function setHandlerForSelector(selectorString, func) {\n    var handlerHasBeenSet = selectorString in handlers\n    var selector = NSSelectorFromString(selectorString)\n\n    handlers[selectorString] = func\n\n    /*\n      For some reason, Mocha acts weird about arguments: https://github.com/logancollins/Mocha/issues/28\n      We have to basically create a dynamic handler with a likewise dynamic number of predefined arguments.\n    */\n    if (!handlerHasBeenSet) {\n      var args = []\n      var regex = /:/g\n      while (regex.exec(selectorString)) {\n        args.push('arg' + args.length)\n      }\n\n      // eslint-disable-next-line no-eval\n      var dynamicFunction = eval(\n        '(function (' +\n          args.join(', ') +\n          ') { return handlers[selectorString].apply(this, arguments); })'\n      )\n\n      delegateClassDesc.addInstanceMethodWithSelector_function(\n        selector,\n        dynamicFunction\n      )\n    }\n  }\n\n  // define a property\n  function setIvar(key, value) {\n    var ivarHasBeenSet = key in handlers\n\n    ivars[key] = value\n\n    if (!ivarHasBeenSet) {\n      delegateClassDesc.addInstanceVariableWithName_typeEncoding(key, '@')\n      var description = MOPropertyDescription.new()\n      description.name = key\n      description.typeEncoding = '@'\n      description.weak = true\n      description.ivarName = key\n      delegateClassDesc.addProperty(description)\n    }\n  }\n\n  this.getClass = function() {\n    return NSClassFromString(uniqueClassName)\n  }\n\n  this.getClassInstance = function(instanceVariables) {\n    var instance = NSClassFromString(uniqueClassName).new()\n    Object.keys(ivars).forEach(function(key) {\n      instance[key] = ivars[key]\n    })\n    Object.keys(instanceVariables || {}).forEach(function(key) {\n      instance[key] = instanceVariables[key]\n    })\n    return instance\n  }\n  // alias\n  this.new = this.getClassInstance\n\n  // Convenience\n  if (typeof definition === 'object') {\n    Object.keys(definition).forEach(\n      function(key) {\n        if (typeof definition[key] === 'function') {\n          setHandlerForSelector(key, definition[key])\n        } else {\n          setIvar(key, definition[key])\n        }\n      }\n    )\n  }\n\n  delegateClassDesc.registerClass()\n}\n","function parseHexColor(color) {\n  // Check the string for incorrect formatting.\n  if (!color || color[0] !== '#') {\n    if (\n      color &&\n      typeof color.isKindOfClass === 'function' &&\n      color.isKindOfClass(NSColor)\n    ) {\n      return color\n    }\n    throw new Error(\n      'Incorrect color formating. It should be an hex color: #RRGGBBAA'\n    )\n  }\n\n  // append FF if alpha channel is not specified.\n  var source = color.substr(1)\n  if (source.length === 3) {\n    source += 'F'\n  } else if (source.length === 6) {\n    source += 'FF'\n  }\n  // Convert the string from #FFF format to #FFFFFF format.\n  var hex\n  if (source.length === 4) {\n    for (var i = 0; i < 4; i += 1) {\n      hex += source[i]\n      hex += source[i]\n    }\n  } else if (source.length === 8) {\n    hex = source\n  } else {\n    return NSColor.whiteColor()\n  }\n\n  var r = parseInt(hex.slice(0, 2), 16)\n  var g = parseInt(hex.slice(2, 4), 16)\n  var b = parseInt(hex.slice(4, 6), 16)\n  var a = parseInt(hex.slice(6, 8), 16)\n\n  return NSColor.colorWithSRGBRed_green_blue_alpha(r, g, b, a)\n}\n\nmodule.exports = function(browserWindow, panel, webview) {\n  // keep reference to the subviews\n  browserWindow._panel = panel\n  browserWindow._webview = webview\n  browserWindow._destroyed = false\n\n  browserWindow.destroy = function() {\n    return panel.close()\n  }\n\n  browserWindow.close = function() {\n    if (panel.delegate().utils && panel.delegate().utils.parentWindow) {\n      var shouldClose = true\n      browserWindow.emit('close', {\n        get defaultPrevented() {\n          return !shouldClose\n        },\n        preventDefault: function() {\n          shouldClose = false\n        },\n      })\n      if (shouldClose) {\n        panel.delegate().utils.parentWindow.endSheet(panel)\n      }\n      return\n    }\n\n    if (!browserWindow.isClosable()) {\n      return\n    }\n\n    panel.performClose(null)\n  }\n\n  function focus(focused) {\n    if (!browserWindow.isVisible()) {\n      return\n    }\n    if (focused) {\n      NSApplication.sharedApplication().activateIgnoringOtherApps(true)\n      panel.makeKeyAndOrderFront(null)\n    } else {\n      panel.orderBack(null)\n      NSApp.mainWindow().makeKeyAndOrderFront(null)\n    }\n  }\n\n  browserWindow.focus = focus.bind(this, true)\n  browserWindow.blur = focus.bind(this, false)\n\n  browserWindow.isFocused = function() {\n    return panel.isKeyWindow()\n  }\n\n  browserWindow.isDestroyed = function() {\n    return browserWindow._destroyed\n  }\n\n  browserWindow.show = function() {\n    // This method is supposed to put focus on window, however if the app does not\n    // have focus then \"makeKeyAndOrderFront\" will only show the window.\n    NSApp.activateIgnoringOtherApps(true)\n\n    if (panel.delegate().utils && panel.delegate().utils.parentWindow) {\n      return panel.delegate().utils.parentWindow.beginSheet_completionHandler(\n        panel,\n        __mocha__.createBlock_function('v16@?0q8', function() {\n          browserWindow.emit('closed')\n        })\n      )\n    }\n\n    return panel.makeKeyAndOrderFront(null)\n  }\n\n  browserWindow.showInactive = function() {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.hide = function() {\n    return panel.orderOut(null)\n  }\n\n  browserWindow.isVisible = function() {\n    return panel.isVisible()\n  }\n\n  browserWindow.isModal = function() {\n    return false\n  }\n\n  browserWindow.maximize = function() {\n    if (!browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n  browserWindow.unmaximize = function() {\n    if (browserWindow.isMaximized()) {\n      panel.zoom(null)\n    }\n  }\n\n  browserWindow.isMaximized = function() {\n    if ((panel.styleMask() & NSResizableWindowMask) !== 0) {\n      return panel.isZoomed()\n    }\n    var rectScreen = NSScreen.mainScreen().visibleFrame()\n    var rectWindow = panel.frame()\n    return (\n      rectScreen.origin.x == rectWindow.origin.x &&\n      rectScreen.origin.y == rectWindow.origin.y &&\n      rectScreen.size.width == rectWindow.size.width &&\n      rectScreen.size.height == rectWindow.size.height\n    )\n  }\n\n  browserWindow.minimize = function() {\n    return panel.miniaturize(null)\n  }\n\n  browserWindow.restore = function() {\n    return panel.deminiaturize(null)\n  }\n\n  browserWindow.isMinimized = function() {\n    return panel.isMiniaturized()\n  }\n\n  browserWindow.setFullScreen = function(fullscreen) {\n    if (fullscreen !== browserWindow.isFullscreen()) {\n      panel.toggleFullScreen(null)\n    }\n  }\n\n  browserWindow.isFullscreen = function() {\n    return panel.styleMask() & NSFullScreenWindowMask\n  }\n\n  browserWindow.setAspectRatio = function(aspectRatio /* , extraSize */) {\n    // Reset the behaviour to default if aspect_ratio is set to 0 or less.\n    if (aspectRatio > 0.0) {\n      panel.setAspectRatio(NSMakeSize(aspectRatio, 1.0))\n    } else {\n      panel.setResizeIncrements(NSMakeSize(1.0, 1.0))\n    }\n  }\n\n  browserWindow.setBounds = function(bounds, animate) {\n    if (!bounds) {\n      return\n    }\n\n    // Do nothing if in fullscreen mode.\n    if (browserWindow.isFullscreen()) {\n      return\n    }\n\n    const newBounds = Object.assign(browserWindow.getBounds(), bounds)\n\n    // TODO: Check size constraints since setFrame does not check it.\n    // var size = bounds.size\n    // size.SetToMax(GetMinimumSize());\n    // gfx::Size max_size = GetMaximumSize();\n    // if (!max_size.IsEmpty())\n    //   size.SetToMin(max_size);\n\n    var cocoaBounds = NSMakeRect(\n      newBounds.x,\n      0,\n      newBounds.width,\n      newBounds.height\n    )\n    // Flip Y coordinates based on the primary screen\n    var screen = NSScreen.screens().firstObject()\n    cocoaBounds.origin.y = NSHeight(screen.frame()) - newBounds.y\n\n    panel.setFrame_display_animate(cocoaBounds, true, animate)\n  }\n\n  browserWindow.getBounds = function() {\n    const cocoaBounds = panel.frame()\n    var mainScreenRect = NSScreen.screens()\n      .firstObject()\n      .frame()\n    return {\n      x: cocoaBounds.origin.x,\n      y: Math.round(NSHeight(mainScreenRect) - cocoaBounds.origin.y),\n      width: cocoaBounds.size.width,\n      height: cocoaBounds.size.height,\n    }\n  }\n\n  browserWindow.setContentBounds = function(bounds, animate) {\n    // TODO:\n    browserWindow.setBounds(bounds, animate)\n  }\n\n  browserWindow.getContentBounds = function() {\n    // TODO:\n    return browserWindow.getBounds()\n  }\n\n  browserWindow.setSize = function(width, height, animate) {\n    // TODO: handle resizing around center\n    return browserWindow.setBounds({ width: width, height: height }, animate)\n  }\n\n  browserWindow.getSize = function() {\n    var bounds = browserWindow.getBounds()\n    return [bounds.width, bounds.height]\n  }\n\n  browserWindow.setContentSize = function(width, height, animate) {\n    // TODO: handle resizing around center\n    return browserWindow.setContentBounds(\n      { width: width, height: height },\n      animate\n    )\n  }\n\n  browserWindow.getContentSize = function() {\n    var bounds = browserWindow.getContentBounds()\n    return [bounds.width, bounds.height]\n  }\n\n  browserWindow.setMinimumSize = function(width, height) {\n    const minSize = CGSizeMake(width, height)\n    panel.setContentMinSize(minSize)\n  }\n\n  browserWindow.getMinimumSize = function() {\n    const size = panel.contentMinSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setMaximumSize = function(width, height) {\n    const maxSize = CGSizeMake(width, height)\n    panel.setContentMaxSize(maxSize)\n  }\n\n  browserWindow.getMaximumSize = function() {\n    const size = panel.contentMaxSize()\n    return [size.width, size.height]\n  }\n\n  browserWindow.setResizable = function(resizable) {\n    return browserWindow._setStyleMask(resizable, NSResizableWindowMask)\n  }\n\n  browserWindow.isResizable = function() {\n    return panel.styleMask() & NSResizableWindowMask\n  }\n\n  browserWindow.setMovable = function(movable) {\n    return panel.setMovable(movable)\n  }\n  browserWindow.isMovable = function() {\n    return panel.isMovable()\n  }\n\n  browserWindow.setMinimizable = function(minimizable) {\n    return browserWindow._setStyleMask(minimizable, NSMiniaturizableWindowMask)\n  }\n\n  browserWindow.isMinimizable = function() {\n    return panel.styleMask() & NSMiniaturizableWindowMask\n  }\n\n  browserWindow.setMaximizable = function(maximizable) {\n    if (panel.standardWindowButton(NSWindowZoomButton)) {\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(maximizable)\n    }\n  }\n\n  browserWindow.isMaximizable = function() {\n    return (\n      panel.standardWindowButton(NSWindowZoomButton) &&\n      panel.standardWindowButton(NSWindowZoomButton).isEnabled()\n    )\n  }\n\n  browserWindow.setFullScreenable = function(fullscreenable) {\n    browserWindow._setCollectionBehavior(\n      fullscreenable,\n      NSWindowCollectionBehaviorFullScreenPrimary\n    )\n    // On EL Capitan this flag is required to hide fullscreen button.\n    browserWindow._setCollectionBehavior(\n      !fullscreenable,\n      NSWindowCollectionBehaviorFullScreenAuxiliary\n    )\n  }\n\n  browserWindow.isFullScreenable = function() {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorFullScreenPrimary\n  }\n\n  browserWindow.setClosable = function(closable) {\n    browserWindow._setStyleMask(closable, NSClosableWindowMask)\n  }\n\n  browserWindow.isClosable = function() {\n    return panel.styleMask() & NSClosableWindowMask\n  }\n\n  browserWindow.setAlwaysOnTop = function(top, level, relativeLevel) {\n    var windowLevel = NSNormalWindowLevel\n    var maxWindowLevel = CGWindowLevelForKey(kCGMaximumWindowLevelKey)\n    var minWindowLevel = CGWindowLevelForKey(kCGMinimumWindowLevelKey)\n\n    if (top) {\n      if (level === 'normal') {\n        windowLevel = NSNormalWindowLevel\n      } else if (level === 'torn-off-menu') {\n        windowLevel = NSTornOffMenuWindowLevel\n      } else if (level === 'modal-panel') {\n        windowLevel = NSModalPanelWindowLevel\n      } else if (level === 'main-menu') {\n        windowLevel = NSMainMenuWindowLevel\n      } else if (level === 'status') {\n        windowLevel = NSStatusWindowLevel\n      } else if (level === 'pop-up-menu') {\n        windowLevel = NSPopUpMenuWindowLevel\n      } else if (level === 'screen-saver') {\n        windowLevel = NSScreenSaverWindowLevel\n      } else if (level === 'dock') {\n        // Deprecated by macOS, but kept for backwards compatibility\n        windowLevel = NSDockWindowLevel\n      } else {\n        windowLevel = NSFloatingWindowLevel\n      }\n    }\n\n    var newLevel = windowLevel + (relativeLevel || 0)\n    if (newLevel >= minWindowLevel && newLevel <= maxWindowLevel) {\n      panel.setLevel(newLevel)\n    } else {\n      throw new Error(\n        'relativeLevel must be between ' +\n          minWindowLevel +\n          ' and ' +\n          maxWindowLevel\n      )\n    }\n  }\n\n  browserWindow.isAlwaysOnTop = function() {\n    return panel.level() !== NSNormalWindowLevel\n  }\n\n  browserWindow.moveTop = function() {\n    return panel.orderFrontRegardless()\n  }\n\n  browserWindow.center = function() {\n    panel.center()\n  }\n\n  browserWindow.setPosition = function(x, y, animate) {\n    return browserWindow.setBounds({ x: x, y: y }, animate)\n  }\n\n  browserWindow.getPosition = function() {\n    var bounds = browserWindow.getBounds()\n    return [bounds.x, bounds.y]\n  }\n\n  browserWindow.setTitle = function(title) {\n    panel.setTitle(title)\n  }\n\n  browserWindow.getTitle = function() {\n    return String(panel.title())\n  }\n\n  var attentionRequestId = 0\n  browserWindow.flashFrame = function(flash) {\n    if (flash) {\n      attentionRequestId = NSApp.requestUserAttention(NSInformationalRequest)\n    } else {\n      NSApp.cancelUserAttentionRequest(attentionRequestId)\n      attentionRequestId = 0\n    }\n  }\n\n  browserWindow.getNativeWindowHandle = function() {\n    return panel\n  }\n\n  browserWindow.getNativeWebViewHandle = function() {\n    return webview\n  }\n\n  browserWindow.loadURL = function(url) {\n    // When frameLocation is a file, prefix it with the Sketch Resources path\n    if (/^(?!https?|file).*\\.html?$/.test(url)) {\n      if (typeof __command !== 'undefined' && __command.pluginBundle()) {\n        url =\n          'file://' +\n          __command\n            .pluginBundle()\n            .urlForResourceNamed(url)\n            .path()\n      }\n    }\n\n    if (/^file:\\/\\/.*\\.html?$/.test(url)) {\n      // ensure URLs containing spaces are properly handled\n      url = NSString.alloc().initWithString(url)\n      url = url.stringByAddingPercentEncodingWithAllowedCharacters(\n        NSCharacterSet.URLQueryAllowedCharacterSet()\n      )\n      webview.loadFileURL_allowingReadAccessToURL(\n        NSURL.URLWithString(url),\n        NSURL.URLWithString('file:///')\n      )\n      return\n    }\n\n    const properURL = NSURL.URLWithString(url)\n    const urlRequest = NSURLRequest.requestWithURL(properURL)\n\n    webview.loadRequest(urlRequest)\n  }\n\n  browserWindow.reload = function() {\n    webview.reload()\n  }\n\n  browserWindow.setHasShadow = function(hasShadow) {\n    return panel.setHasShadow(hasShadow)\n  }\n\n  browserWindow.hasShadow = function() {\n    return panel.hasShadow()\n  }\n\n  browserWindow.setOpacity = function(opacity) {\n    return panel.setAlphaValue(opacity)\n  }\n\n  browserWindow.getOpacity = function() {\n    return panel.alphaValue()\n  }\n\n  browserWindow.setVisibleOnAllWorkspaces = function(visible) {\n    return browserWindow._setCollectionBehavior(\n      visible,\n      NSWindowCollectionBehaviorCanJoinAllSpaces\n    )\n  }\n\n  browserWindow.isVisibleOnAllWorkspaces = function() {\n    var collectionBehavior = panel.collectionBehavior()\n    return collectionBehavior & NSWindowCollectionBehaviorCanJoinAllSpaces\n  }\n\n  browserWindow.setIgnoreMouseEvents = function(ignore) {\n    return panel.setIgnoresMouseEvents(ignore)\n  }\n\n  browserWindow.setContentProtection = function(enable) {\n    panel.setSharingType(enable ? NSWindowSharingNone : NSWindowSharingReadOnly)\n  }\n\n  browserWindow.setAutoHideCursor = function(autoHide) {\n    panel.setDisableAutoHideCursor(autoHide)\n  }\n\n  browserWindow.setVibrancy = function(type) {\n    var effectView = browserWindow._vibrantView\n\n    if (!type) {\n      if (effectView == null) {\n        return\n      }\n\n      effectView.removeFromSuperview()\n      panel.setVibrantView(null)\n      return\n    }\n\n    if (effectView == null) {\n      var contentView = panel.contentView()\n      effectView = NSVisualEffectView.alloc().initWithFrame(\n        contentView.bounds()\n      )\n      browserWindow._vibrantView = effectView\n\n      effectView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n      effectView.setBlendingMode(NSVisualEffectBlendingModeBehindWindow)\n      effectView.setState(NSVisualEffectStateActive)\n      effectView.setFrame(contentView.bounds())\n      contentView.addSubview_positioned_relativeTo(\n        effectView,\n        NSWindowBelow,\n        null\n      )\n    }\n\n    var vibrancyType = NSVisualEffectMaterialLight\n\n    if (type === 'appearance-based') {\n      vibrancyType = NSVisualEffectMaterialAppearanceBased\n    } else if (type === 'light') {\n      vibrancyType = NSVisualEffectMaterialLight\n    } else if (type === 'dark') {\n      vibrancyType = NSVisualEffectMaterialDark\n    } else if (type === 'titlebar') {\n      vibrancyType = NSVisualEffectMaterialTitlebar\n    } else if (type === 'selection') {\n      vibrancyType = NSVisualEffectMaterialSelection\n    } else if (type === 'menu') {\n      vibrancyType = NSVisualEffectMaterialMenu\n    } else if (type === 'popover') {\n      vibrancyType = NSVisualEffectMaterialPopover\n    } else if (type === 'sidebar') {\n      vibrancyType = NSVisualEffectMaterialSidebar\n    } else if (type === 'medium-light') {\n      vibrancyType = NSVisualEffectMaterialMediumLight\n    } else if (type === 'ultra-dark') {\n      vibrancyType = NSVisualEffectMaterialUltraDark\n    }\n\n    effectView.setMaterial(vibrancyType)\n  }\n\n  browserWindow._setBackgroundColor = function(colorName) {\n    var color = parseHexColor(colorName)\n    webview.setValue_forKey(false, 'drawsBackground')\n    panel.backgroundColor = color\n  }\n\n  browserWindow._invalidate = function() {\n    panel.flushWindow()\n    panel.contentView().setNeedsDisplay(true)\n  }\n\n  browserWindow._setStyleMask = function(on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setStyleMask(panel.styleMask() | flag)\n    } else {\n      panel.setStyleMask(panel.styleMask() & ~flag)\n    }\n    // Change style mask will make the zoom button revert to default, probably\n    // a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._setCollectionBehavior = function(on, flag) {\n    var wasMaximizable = browserWindow.isMaximizable()\n    if (on) {\n      panel.setCollectionBehavior(panel.collectionBehavior() | flag)\n    } else {\n      panel.setCollectionBehavior(panel.collectionBehavior() & ~flag)\n    }\n    // Change collectionBehavior will make the zoom button revert to default,\n    // probably a bug of Cocoa or macOS.\n    browserWindow.setMaximizable(wasMaximizable)\n  }\n\n  browserWindow._showWindowButton = function(button) {\n    var view = panel.standardWindowButton(button)\n    view.superview().addSubview_positioned_relative(view, NSWindowAbove, null)\n  }\n}\n","module.exports = {\n  JS_BRIDGE: '__skpm_sketchBridge',\n  JS_BRIDGE_RESULT_SUCCESS: '__skpm_sketchBridge_success',\n  JS_BRIDGE_RESULT_ERROR: '__skpm_sketchBridge_error',\n  START_MOVING_WINDOW: '__skpm_startMovingWindow',\n  EXECUTE_JAVASCRIPT: '__skpm_executeJS',\n  EXECUTE_JAVASCRIPT_SUCCESS: '__skpm_executeJS_success_',\n  EXECUTE_JAVASCRIPT_ERROR: '__skpm_executeJS_error_',\n}\n","var tagsToFocus =\n  '[\"text\", \"textarea\", \"date\", \"datetime-local\", \"email\", \"number\", \"month\", \"password\", \"search\", \"tel\", \"time\", \"url\", \"week\" ]'\n\nmodule.exports = function(webView, event) {\n  var point = webView.convertPoint_fromView(event.locationInWindow(), null)\n  return (\n    'var el = document.elementFromPoint(' + // get the DOM element that match the event\n    point.x +\n    ', ' +\n    point.y +\n    '); ' +\n    'if (el && el.tagName === \"SELECT\") {' + // select needs special handling\n    '  var event = document.createEvent(\"MouseEvents\");' +\n    '  event.initMouseEvent(\"mousedown\", true, true, window);' +\n    '  el.dispatchEvent(event);' +\n    '} else if (el && ' + // some tags need to be focused instead of clicked\n    tagsToFocus +\n    '.indexOf(el.type) >= 0 && ' +\n    'el.focus' +\n    ') {' +\n    'el.focus();' + // so focus them\n    '} else if (el) {' +\n    'el.dispatchEvent(new Event(\"click\", {bubbles: true}))' + // click the others\n    '}'\n  )\n}\n","var CONSTANTS = require('./constants')\n\nmodule.exports = function(webview, browserWindow) {\n  function executeJavaScript(script, userGesture, callback) {\n    if (typeof userGesture === 'function') {\n      callback = userGesture\n      userGesture = false\n    }\n    var fiber = coscript.createFiber()\n\n    // if the webview is not ready yet, defer the execution until it is\n    if (\n      webview.navigationDelegate().state &&\n      webview.navigationDelegate().state.wasReady == 0\n    ) {\n      return new Promise(function(resolve, reject) {\n        browserWindow.once('ready-to-show', function() {\n          executeJavaScript(script, userGesture, callback)\n            .then(resolve)\n            .catch(reject)\n          fiber.cleanup()\n        })\n      })\n    }\n\n    return new Promise(function(resolve, reject) {\n      var requestId = Math.random()\n\n      browserWindow.webContents.on(\n        CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS + requestId,\n        function(res) {\n          try {\n            if (callback) {\n              callback(null, res)\n            }\n            resolve(res)\n          } catch (err) {\n            reject(err)\n          }\n          fiber.cleanup()\n        }\n      )\n      browserWindow.webContents.on(\n        CONSTANTS.EXECUTE_JAVASCRIPT_ERROR + requestId,\n        function(err) {\n          try {\n            if (callback) {\n              callback(err)\n              resolve()\n            } else {\n              reject(err)\n            }\n          } catch (err2) {\n            reject(err2)\n          }\n          fiber.cleanup()\n        }\n      )\n\n      webview.evaluateJavaScript_completionHandler(\n        module.exports.wrapScript(script, requestId),\n        null\n      )\n    })\n  }\n\n  return executeJavaScript\n}\n\nmodule.exports.wrapScript = function(script, requestId) {\n  return (\n    'window.' +\n    CONSTANTS.EXECUTE_JAVASCRIPT +\n    '(' +\n    requestId +\n    ', ' +\n    JSON.stringify(script) +\n    ')'\n  )\n}\n\nmodule.exports.injectScript = function(webView) {\n  var source =\n    'window.' +\n    CONSTANTS.EXECUTE_JAVASCRIPT +\n    ' = function(id, script) {' +\n    '  try {' +\n    '    var res = eval(script);' +\n    '    if (res && typeof res.then === \"function\" && typeof res.catch === \"function\") {' +\n    '      res.then(function (res2) {' +\n    '        window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS +\n    '\" + id, res2);' +\n    '      })' +\n    '      .catch(function (err) {' +\n    '        window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_ERROR +\n    '\" + id, err);' +\n    '      })' +\n    '    } else {' +\n    '      window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_SUCCESS +\n    '\" + id, res);' +\n    '    }' +\n    '  } catch (err) {' +\n    '    window.postMessage(\"' +\n    CONSTANTS.EXECUTE_JAVASCRIPT_ERROR +\n    '\" + id, err);' +\n    '  }' +\n    '}'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n","function addEdgeConstraint(edge, subview, view, constant) {\n  view.addConstraint(\n    NSLayoutConstraint.constraintWithItem_attribute_relatedBy_toItem_attribute_multiplier_constant(\n      subview,\n      edge,\n      NSLayoutRelationEqual,\n      view,\n      edge,\n      1,\n      constant\n    )\n  )\n}\nmodule.exports = function fitSubviewToView(subview, view, constants) {\n  constants = constants || []\n  subview.setTranslatesAutoresizingMaskIntoConstraints(false)\n\n  addEdgeConstraint(NSLayoutAttributeLeft, subview, view, constants[0] || 0)\n  addEdgeConstraint(NSLayoutAttributeTop, subview, view, constants[1] || 0)\n  addEdgeConstraint(NSLayoutAttributeRight, subview, view, constants[2] || 0)\n  addEdgeConstraint(NSLayoutAttributeBottom, subview, view, constants[3] || 0)\n}\n","/* let's try to match the API from Electron's Browser window\n(https://github.com/electron/electron/blob/master/docs/api/browser-window.md) */\nvar EventEmitter = require('events')\nvar buildBrowserAPI = require('./browser-api')\nvar buildWebAPI = require('./webview-api')\nvar fitSubviewToView = require('./fitSubview')\nvar dispatchFirstClick = require('./dispatch-first-click')\nvar injectClientMessaging = require('./inject-client-messaging')\nvar movableArea = require('./movable-area')\nvar executeJavaScript = require('./execute-javascript')\nvar setDelegates = require('./set-delegates')\n\nfunction BrowserWindow(options) {\n  options = options || {}\n\n  var identifier = options.identifier || NSUUID.UUID().UUIDString()\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  var existingBrowserWindow = BrowserWindow.fromId(identifier)\n\n  // if we already have a window opened, reuse it\n  if (existingBrowserWindow) {\n    return existingBrowserWindow\n  }\n\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  if (options.modal && !options.parent) {\n    throw new Error('A modal needs to have a parent.')\n  }\n\n  // Long-running script\n  var fiber = coscript.createFiber()\n\n  // Window size\n  var width = options.width || 800\n  var height = options.height || 600\n  var mainScreenRect = NSScreen.screens()\n    .firstObject()\n    .frame()\n  var cocoaBounds = NSMakeRect(\n    typeof options.x !== 'undefined'\n      ? options.x\n      : Math.round((NSWidth(mainScreenRect) - width) / 2),\n    typeof options.y !== 'undefined'\n      ? NSHeight(mainScreenRect) - options.y\n      : Math.round((NSHeight(mainScreenRect) - height) / 2),\n    width,\n    height\n  )\n\n  if (options.titleBarStyle && options.titleBarStyle !== 'default') {\n    options.frame = false\n  }\n\n  var useStandardWindow = options.windowType !== 'textured'\n  var styleMask = NSTitledWindowMask\n\n  // this is commented out because the toolbar doesn't appear otherwise :thinking-face:\n  // if (!useStandardWindow || options.frame === false) {\n  //   styleMask = NSFullSizeContentViewWindowMask\n  // }\n  if (options.minimizable !== false) {\n    styleMask |= NSMiniaturizableWindowMask\n  }\n  if (options.closable !== false) {\n    styleMask |= NSClosableWindowMask\n  }\n  if (options.resizable !== false) {\n    styleMask |= NSResizableWindowMask\n  }\n  if (!useStandardWindow || options.transparent || options.frame === false) {\n    styleMask |= NSTexturedBackgroundWindowMask\n  }\n\n  var panel = NSPanel.alloc().initWithContentRect_styleMask_backing_defer(\n    cocoaBounds,\n    styleMask,\n    NSBackingStoreBuffered,\n    true\n  )\n\n  var wkwebviewConfig = WKWebViewConfiguration.alloc().init()\n  var webView = WKWebView.alloc().initWithFrame_configuration(\n    CGRectMake(0, 0, options.width || 800, options.height || 600),\n    wkwebviewConfig\n  )\n  injectClientMessaging(webView)\n  webView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n  setDelegates(browserWindow, panel, webView, options)\n\n  if (options.windowType === 'desktop') {\n    panel.setLevel(kCGDesktopWindowLevel - 1)\n    // panel.setCanBecomeKeyWindow(false)\n    panel.setCollectionBehavior(\n      NSWindowCollectionBehaviorCanJoinAllSpaces |\n        NSWindowCollectionBehaviorStationary |\n        NSWindowCollectionBehaviorIgnoresCycle\n    )\n  }\n\n  if (\n    typeof options.minWidth !== 'undefined' ||\n    typeof options.minHeight !== 'undefined'\n  ) {\n    browserWindow.setMinimumSize(options.minWidth || 0, options.minHeight || 0)\n  }\n\n  if (\n    typeof options.maxWidth !== 'undefined' ||\n    typeof options.maxHeight !== 'undefined'\n  ) {\n    browserWindow.setMaximumSize(\n      options.maxWidth || 10000,\n      options.maxHeight || 10000\n    )\n  }\n\n  // if (options.focusable === false) {\n  //   panel.setCanBecomeKeyWindow(false)\n  // }\n\n  if (options.transparent || options.frame === false) {\n    panel.titlebarAppearsTransparent = true\n    panel.titleVisibility = NSWindowTitleHidden\n    panel.setOpaque(0)\n    panel.isMovableByWindowBackground = true\n    var toolbar2 = NSToolbar.alloc().initWithIdentifier(\n      'titlebarStylingToolbar'\n    )\n    toolbar2.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar2)\n  }\n\n  if (options.titleBarStyle === 'hiddenInset') {\n    var toolbar = NSToolbar.alloc().initWithIdentifier('titlebarStylingToolbar')\n    toolbar.setShowsBaselineSeparator(false)\n    panel.setToolbar(toolbar)\n  }\n\n  if (options.frame === false || !options.useContentSize) {\n    browserWindow.setSize(width, height)\n  }\n\n  if (options.center) {\n    browserWindow.center()\n  }\n\n  if (options.alwaysOnTop) {\n    browserWindow.setAlwaysOnTop(true)\n  }\n\n  if (options.fullscreen) {\n    browserWindow.setFullScreen(true)\n  }\n  browserWindow.setFullScreenable(!!options.fullscreenable)\n\n  let title = options.title\n  if (options.frame === false) {\n    title = undefined\n  } else if (\n    typeof title === 'undefined' &&\n    typeof __command !== 'undefined' &&\n    __command.pluginBundle()\n  ) {\n    title = __command.pluginBundle().name()\n  }\n\n  if (title) {\n    browserWindow.setTitle(title)\n  }\n\n  var backgroundColor = options.backgroundColor\n  if (options.transparent) {\n    backgroundColor = NSColor.clearColor()\n  }\n  if (!backgroundColor && options.frame === false && options.vibrancy) {\n    backgroundColor = NSColor.clearColor()\n  }\n\n  browserWindow._setBackgroundColor(\n    backgroundColor || NSColor.windowBackgroundColor()\n  )\n\n  if (options.hasShadow === false) {\n    browserWindow.setHasShadow(false)\n  }\n\n  if (typeof options.opacity !== 'undefined') {\n    browserWindow.setOpacity(options.opacity)\n  }\n\n  options.webPreferences = options.webPreferences || {}\n\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.devTools !== false,\n      'developerExtrasEnabled'\n    )\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.javascript !== false,\n      'javaScriptEnabled'\n    )\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(!!options.webPreferences.plugins, 'plugInsEnabled')\n  webView\n    .configuration()\n    .preferences()\n    .setValue_forKey(\n      options.webPreferences.minimumFontSize || 0,\n      'minimumFontSize'\n    )\n\n  if (options.webPreferences.zoomFactor) {\n    webView.setMagnification(options.webPreferences.zoomFactor)\n  }\n\n  var contentView = panel.contentView()\n\n  if (options.frame !== false) {\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n  } else {\n    // In OSX 10.10, adding subviews to the root view for the NSView hierarchy\n    // produces warnings. To eliminate the warnings, we resize the contentView\n    // to fill the window, and add subviews to that.\n    // http://crbug.com/380412\n    contentView.setAutoresizingMask(NSViewWidthSizable | NSViewHeightSizable)\n    fitSubviewToView(contentView, contentView.superview())\n\n    webView.setFrame(contentView.bounds())\n    contentView.addSubview(webView)\n\n    // The fullscreen button should always be hidden for frameless window.\n    if (panel.standardWindowButton(NSWindowFullScreenButton)) {\n      panel.standardWindowButton(NSWindowFullScreenButton).setHidden(true)\n    }\n\n    if (!options.titleBarStyle || options.titleBarStyle === 'default') {\n      // Hide the window buttons.\n      panel.standardWindowButton(NSWindowZoomButton).setHidden(true)\n      panel.standardWindowButton(NSWindowMiniaturizeButton).setHidden(true)\n      panel.standardWindowButton(NSWindowCloseButton).setHidden(true)\n\n      // Some third-party macOS utilities check the zoom button's enabled state to\n      // determine whether to show custom UI on hover, so we disable it here to\n      // prevent them from doing so in a frameless app window.\n      panel.standardWindowButton(NSWindowZoomButton).setEnabled(false)\n    }\n  }\n\n  if (options.vibrancy) {\n    browserWindow.setVibrancy(options.vibrancy)\n  }\n\n  // Set maximizable state last to ensure zoom button does not get reset\n  // by calls to other APIs.\n  browserWindow.setMaximizable(options.maximizable !== false)\n\n  panel.setHidesOnDeactivate(options.hidesOnDeactivate !== false)\n\n  if (options.remembersWindowFrame) {\n    panel.setFrameAutosaveName(identifier)\n    panel.setFrameUsingName_force(panel.frameAutosaveName(), false)\n  }\n\n  if (options.acceptsFirstMouse) {\n    browserWindow.on('focus', function(event) {\n      if (event.type() === NSEventTypeLeftMouseDown) {\n        browserWindow.webContents\n          .executeJavaScript(dispatchFirstClick(webView, event))\n          .catch(() => {})\n      }\n    })\n  }\n\n  executeJavaScript.injectScript(webView)\n  movableArea.injectScript(webView)\n  movableArea.setupHandler(browserWindow)\n\n  if (options.show !== false) {\n    browserWindow.show()\n  }\n\n  browserWindow.on('closed', function() {\n    browserWindow._destroyed = true\n    threadDictionary.removeObjectForKey(identifier)\n    var observer = threadDictionary[identifier + '.themeObserver']\n    if (observer) {\n      NSApplication.sharedApplication().removeObserver_forKeyPath(\n        observer,\n        'effectiveAppearance'\n      )\n      threadDictionary.removeObjectForKey(identifier + '.themeObserver')\n    }\n    fiber.cleanup()\n  })\n\n  threadDictionary[identifier] = panel\n\n  fiber.onCleanup(function() {\n    if (!browserWindow._destroyed) {\n      browserWindow.destroy()\n    }\n  })\n\n  return browserWindow\n}\n\nBrowserWindow.fromId = function(identifier) {\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n\n  if (threadDictionary[identifier]) {\n    return BrowserWindow.fromPanel(threadDictionary[identifier], identifier)\n  }\n\n  return undefined\n}\n\nBrowserWindow.fromPanel = function(panel, identifier) {\n  var browserWindow = new EventEmitter()\n  browserWindow.id = identifier\n\n  if (!panel || !panel.contentView) {\n    throw new Error('needs to pass an NSPanel')\n  }\n\n  var webView = null\n  var subviews = panel.contentView().subviews()\n  for (var i = 0; i < subviews.length; i += 1) {\n    if (\n      !webView &&\n      !subviews[i].isKindOfClass(WKInspectorWKWebView) &&\n      subviews[i].isKindOfClass(WKWebView)\n    ) {\n      webView = subviews[i]\n    }\n  }\n\n  if (!webView) {\n    throw new Error('The panel needs to have a webview')\n  }\n\n  buildBrowserAPI(browserWindow, panel, webView)\n  buildWebAPI(browserWindow, panel, webView)\n\n  return browserWindow\n}\n\nmodule.exports = BrowserWindow\n","var CONSTANTS = require('./constants')\n\nmodule.exports = function(webView) {\n  var source =\n    'window.originalPostMessage = window.postMessage;' +\n    'window.postMessage = function(actionName) {' +\n    '  if (!actionName) {' +\n    \"    throw new Error('missing action name')\" +\n    '  }' +\n    '  var id = String(Math.random()).replace(\".\", \"\");' +\n    '    var args = [].slice.call(arguments);' +\n    '    args.unshift(id);' +\n    '  return new Promise(function (resolve, reject) {' +\n    '    window[\"' +\n    CONSTANTS.JS_BRIDGE_RESULT_SUCCESS +\n    '\" + id] = resolve;' +\n    '    window[\"' +\n    CONSTANTS.JS_BRIDGE_RESULT_ERROR +\n    '\" + id] = reject;' +\n    '    window.webkit.messageHandlers.' +\n    CONSTANTS.JS_BRIDGE +\n    '.postMessage(JSON.stringify(args));' +\n    '  });' +\n    '}'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n","var CONSTANTS = require('./constants')\n\nmodule.exports.injectScript = function(webView) {\n  var source =\n    '(function () {' +\n    \"document.addEventListener('mousedown', onMouseDown);\" +\n    '' +\n    'function shouldDrag(target) {' +\n    '  if (!target || (target.dataset || {}).appRegion === \"no-drag\") { return false }' +\n    '  if ((target.dataset || {}).appRegion === \"drag\") { return true }' +\n    '  return shouldDrag(target.parentElement)' +\n    '};' +\n    '' +\n    'function onMouseDown(e) {' +\n    '  if (e.button !== 0 || !shouldDrag(e.target)) { return }' +\n    '  window.postMessage(\"' +\n    CONSTANTS.START_MOVING_WINDOW +\n    '\");' +\n    '};' +\n    '})()'\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    source,\n    0,\n    true\n  )\n  webView\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n}\n\nmodule.exports.setupHandler = function(browserWindow) {\n  var initialMouseLocation = null\n  var initialWindowPosition = null\n  var interval = null\n\n  function moveWindow() {\n    // if the user released the button, stop moving the window\n    if (!initialWindowPosition || NSEvent.pressedMouseButtons() !== 1) {\n      clearInterval(interval)\n      initialMouseLocation = null\n      initialWindowPosition = null\n      return\n    }\n\n    var mouse = NSEvent.mouseLocation()\n    browserWindow.setPosition(\n      initialWindowPosition.x + (mouse.x - initialMouseLocation.x),\n      initialWindowPosition.y + (initialMouseLocation.y - mouse.y), // y is inverted\n      false\n    )\n  }\n\n  browserWindow.webContents.on(CONSTANTS.START_MOVING_WINDOW, function() {\n    initialMouseLocation = NSEvent.mouseLocation()\n    var position = browserWindow.getPosition()\n    initialWindowPosition = {\n      x: position[0],\n      y: position[1],\n    }\n\n    interval = setInterval(moveWindow, 1000 / 60) // 60 fps\n  })\n}\n","module.exports = function(webArguments) {\n  var args = null\n  try {\n    args = JSON.parse(webArguments)\n  } catch (e) {\n    // malformed arguments\n  }\n\n  if (\n    !args ||\n    !args.constructor ||\n    args.constructor !== Array ||\n    args.length == 0\n  ) {\n    return null\n  }\n\n  return args\n}\n","var ObjCClass = require('mocha-js-delegate')\nvar parseWebArguments = require('./parseWebArguments')\nvar CONSTANTS = require('./constants')\n\n// We create one ObjC class for ourselves here\nvar WindowDelegateClass\nvar NavigationDelegateClass\nvar WebScriptHandlerClass\nvar ThemeObserverClass\n\n// TODO: events\n// - 'page-favicon-updated'\n// - 'new-window'\n// - 'did-navigate-in-page'\n// - 'will-prevent-unload'\n// - 'crashed'\n// - 'unresponsive'\n// - 'responsive'\n// - 'destroyed'\n// - 'before-input-event'\n// - 'certificate-error'\n// - 'found-in-page'\n// - 'media-started-playing'\n// - 'media-paused'\n// - 'did-change-theme-color'\n// - 'update-target-url'\n// - 'cursor-changed'\n// - 'context-menu'\n// - 'select-bluetooth-device'\n// - 'paint'\n// - 'console-message'\n\nmodule.exports = function(browserWindow, panel, webview, options) {\n  if (!ThemeObserverClass) {\n    ThemeObserverClass = new ObjCClass({\n      utils: null,\n\n      'observeValueForKeyPath:ofObject:change:context:': function() {\n        this.utils.executeJavaScript(\n          \"document.body.classList.remove('__skpm-\" +\n            (typeof MSTheme !== 'undefined' && MSTheme.sharedTheme().isDark()\n              ? 'light'\n              : 'dark') +\n            \"'); document.body.classList.add('__skpm-\" +\n            (typeof MSTheme !== 'undefined' && MSTheme.sharedTheme().isDark()\n              ? 'dark'\n              : 'light') +\n            \"')\"\n        )\n      },\n    })\n  }\n\n  if (!WindowDelegateClass) {\n    WindowDelegateClass = new ObjCClass({\n      utils: null,\n      panel: null,\n\n      'windowDidResize:': function() {\n        this.utils.emit('resize')\n      },\n\n      'windowDidMiniaturize:': function() {\n        this.utils.emit('minimize')\n      },\n\n      'windowDidDeminiaturize:': function() {\n        this.utils.emit('restore')\n      },\n\n      'windowDidEnterFullScreen:': function() {\n        this.utils.emit('enter-full-screen')\n      },\n\n      'windowDidExitFullScreen:': function() {\n        this.utils.emit('leave-full-screen')\n      },\n\n      'windowDidMove:': function() {\n        this.utils.emit('move')\n        this.utils.emit('moved')\n      },\n\n      'windowShouldClose:': function() {\n        var shouldClose = 1\n        this.utils.emit('close', {\n          get defaultPrevented() {\n            return !shouldClose\n          },\n          preventDefault: function() {\n            shouldClose = 0\n          },\n        })\n        return shouldClose\n      },\n\n      'windowWillClose:': function() {\n        this.utils.emit('closed')\n      },\n\n      'windowDidBecomeKey:': function() {\n        this.utils.emit('focus', this.panel.currentEvent())\n      },\n\n      'windowDidResignKey:': function() {\n        this.utils.emit('blur')\n      },\n    })\n  }\n\n  if (!NavigationDelegateClass) {\n    NavigationDelegateClass = new ObjCClass({\n      state: {\n        wasReady: 0,\n      },\n      utils: null,\n\n      // // Called when the web view begins to receive web content.\n      'webView:didCommitNavigation:': function(webView) {\n        this.utils.emit('will-navigate', {}, String(String(webView.URL())))\n      },\n\n      // // Called when web content begins to load in a web view.\n      'webView:didStartProvisionalNavigation:': function() {\n        this.utils.emit('did-start-navigation')\n        this.utils.emit('did-start-loading')\n      },\n\n      // Called when a web view receives a server redirect.\n      'webView:didReceiveServerRedirectForProvisionalNavigation:': function() {\n        this.utils.emit('did-get-redirect-request')\n      },\n\n      // // Called when the web view needs to respond to an authentication challenge.\n      // 'webView:didReceiveAuthenticationChallenge:completionHandler:': function(\n      //   webView,\n      //   challenge,\n      //   completionHandler\n      // ) {\n      //   function callback(username, password) {\n      //     completionHandler(\n      //       0,\n      //       NSURLCredential.credentialWithUser_password_persistence(\n      //         username,\n      //         password,\n      //         1\n      //       )\n      //     )\n      //   }\n      //   var protectionSpace = challenge.protectionSpace()\n      //   this.utils.emit(\n      //     'login',\n      //     {},\n      //     {\n      //       method: String(protectionSpace.authenticationMethod()),\n      //       url: 'not implemented', // TODO:\n      //       referrer: 'not implemented', // TODO:\n      //     },\n      //     {\n      //       isProxy: !!protectionSpace.isProxy(),\n      //       scheme: String(protectionSpace.protocol()),\n      //       host: String(protectionSpace.host()),\n      //       port: Number(protectionSpace.port()),\n      //       realm: String(protectionSpace.realm()),\n      //     },\n      //     callback\n      //   )\n      // },\n\n      // Called when an error occurs during navigation.\n      // 'webView:didFailNavigation:withError:': function(\n      //   webView,\n      //   navigation,\n      //   error\n      // ) {},\n\n      // Called when an error occurs while the web view is loading content.\n      'webView:didFailProvisionalNavigation:withError:': function(\n        webView,\n        navigation,\n        error\n      ) {\n        this.utils.emit('did-fail-load', error)\n      },\n\n      // Called when the navigation is complete.\n      'webView:didFinishNavigation:': function() {\n        if (this.state.wasReady == 0) {\n          this.state.wasReady = 1\n          this.utils.emitBrowserEvent('ready-to-show')\n        }\n        this.utils.emit('did-navigate')\n        this.utils.emit('did-frame-navigate')\n        this.utils.emit('did-stop-loading')\n        this.utils.emit('did-finish-load')\n        this.utils.emit('did-frame-finish-load')\n      },\n\n      // Called when the web views web content process is terminated.\n      'webViewWebContentProcessDidTerminate:': function() {\n        this.utils.emit('dom-ready')\n      },\n\n      // Decides whether to allow or cancel a navigation.\n      // webView:decidePolicyForNavigationAction:decisionHandler:\n\n      // Decides whether to allow or cancel a navigation after its response is known.\n      // webView:decidePolicyForNavigationResponse:decisionHandler:\n    })\n  }\n\n  if (!WebScriptHandlerClass) {\n    WebScriptHandlerClass = new ObjCClass({\n      utils: null,\n      'userContentController:didReceiveScriptMessage:': function(_, message) {\n        var args = this.utils.parseWebArguments(String(message.body()))\n        if (!args) {\n          return\n        }\n        if (!args[0] || typeof args[0] !== 'string') {\n          return\n        }\n        args[0] = String(args[0])\n\n        this.utils.emit.apply(this, args)\n      },\n    })\n  }\n\n  var themeObserver = ThemeObserverClass.new({\n    utils: {\n      executeJavaScript(script) {\n        webview.evaluateJavaScript_completionHandler(script, null)\n      },\n    },\n  })\n\n  var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n    \"document.addEventListener('DOMContentLoaded', function() { document.body.classList.add('__skpm-\" +\n      (typeof MSTheme !== 'undefined' && MSTheme.sharedTheme().isDark()\n        ? 'dark'\n        : 'light') +\n      \"') }, false)\",\n    0,\n    true\n  )\n  webview\n    .configuration()\n    .userContentController()\n    .addUserScript(script)\n\n  NSApplication.sharedApplication().addObserver_forKeyPath_options_context(\n    themeObserver,\n    'effectiveAppearance',\n    NSKeyValueChangeNewKey,\n    null\n  )\n\n  var threadDictionary = NSThread.mainThread().threadDictionary()\n  threadDictionary[browserWindow.id + '.themeObserver'] = themeObserver\n\n  var navigationDelegate = NavigationDelegateClass.new({\n    utils: {\n      setTitle: browserWindow.setTitle.bind(browserWindow),\n      emitBrowserEvent() {\n        try {\n          browserWindow.emit.apply(browserWindow, arguments)\n        } catch (err) {\n          if (\n            typeof process !== 'undefined' &&\n            process.listenerCount &&\n            process.listenerCount('uncaughtException')\n          ) {\n            process.emit('uncaughtException', err, 'uncaughtException')\n          } else {\n            console.error(err)\n            throw err\n          }\n        }\n      },\n      emit() {\n        try {\n          browserWindow.webContents.emit.apply(\n            browserWindow.webContents,\n            arguments\n          )\n        } catch (err) {\n          if (\n            typeof process !== 'undefined' &&\n            process.listenerCount &&\n            process.listenerCount('uncaughtException')\n          ) {\n            process.emit('uncaughtException', err, 'uncaughtException')\n          } else {\n            console.error(err)\n            throw err\n          }\n        }\n      },\n    },\n    state: {\n      wasReady: 0,\n    },\n  })\n\n  webview.setNavigationDelegate(navigationDelegate)\n\n  var webScriptHandler = WebScriptHandlerClass.new({\n    utils: {\n      emit(id, type) {\n        if (!type) {\n          webview.evaluateJavaScript_completionHandler(\n            CONSTANTS.JS_BRIDGE_RESULT_SUCCESS + id + '()',\n            null\n          )\n          return\n        }\n\n        var args = []\n        for (var i = 2; i < arguments.length; i += 1) args.push(arguments[i])\n\n        var listeners = browserWindow.webContents.listeners(type)\n\n        Promise.all(\n          listeners.map(function(l) {\n            return Promise.resolve().then(function() {\n              return l.apply(l, args)\n            })\n          })\n        )\n          .then(function(res) {\n            webview.evaluateJavaScript_completionHandler(\n              CONSTANTS.JS_BRIDGE_RESULT_SUCCESS +\n                id +\n                '(' +\n                JSON.stringify(res) +\n                ')',\n              null\n            )\n          })\n          .catch(function(err) {\n            webview.evaluateJavaScript_completionHandler(\n              CONSTANTS.JS_BRIDGE_RESULT_ERROR +\n                id +\n                '(' +\n                JSON.stringify(err) +\n                ')',\n              null\n            )\n          })\n      },\n      parseWebArguments: parseWebArguments,\n    },\n  })\n\n  webview\n    .configuration()\n    .userContentController()\n    .addScriptMessageHandler_name(webScriptHandler, CONSTANTS.JS_BRIDGE)\n\n  var utils = {\n    emit() {\n      try {\n        browserWindow.emit.apply(browserWindow, arguments)\n      } catch (err) {\n        if (\n          typeof process !== 'undefined' &&\n          process.listenerCount &&\n          process.listenerCount('uncaughtException')\n        ) {\n          process.emit('uncaughtException', err, 'uncaughtException')\n        } else {\n          console.error(err)\n          throw err\n        }\n      }\n    },\n  }\n  if (options.modal) {\n    // find the window of the document\n    var msdocument\n    if (options.parent.type === 'Document') {\n      msdocument = options.parent.sketchObject\n    } else {\n      msdocument = options.parent\n    }\n    if (msdocument && String(msdocument.class()) === 'MSDocumentData') {\n      // we only have an MSDocumentData instead of a MSDocument\n      // let's try to get back to the MSDocument\n      msdocument = msdocument.delegate()\n    }\n    utils.parentWindow = msdocument.windowForSheet()\n  }\n\n  var windowDelegate = WindowDelegateClass.new({\n    utils: utils,\n    panel: panel,\n  })\n\n  panel.setDelegate(windowDelegate)\n}\n","var EventEmitter = require('events')\nvar executeJavaScript = require('./execute-javascript')\n\n// let's try to match https://github.com/electron/electron/blob/master/docs/api/web-contents.md\nmodule.exports = function buildAPI(browserWindow, panel, webview) {\n  var webContents = new EventEmitter()\n\n  webContents.loadURL = browserWindow.loadURL\n\n  webContents.loadFile = function(/* filePath */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.downloadURL = function(/* filePath */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.getURL = function() {\n    return String(webview.url())\n  }\n\n  webContents.getTitle = function() {\n    return String(webview.title())\n  }\n\n  webContents.isDestroyed = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  webContents.focus = browserWindow.focus\n  webContents.isFocused = browserWindow.isFocused\n\n  webContents.isLoading = function() {\n    return !!webview.loading()\n  }\n\n  webContents.isLoadingMainFrame = function() {\n    // TODO:\n    return !!webview.loading()\n  }\n\n  webContents.isWaitingForResponse = function() {\n    return !webview.loading()\n  }\n\n  webContents.stop = function() {\n    webview.stopLoading()\n  }\n  webContents.reload = function() {\n    webview.reload()\n  }\n  webContents.reloadIgnoringCache = function() {\n    webview.reloadFromOrigin()\n  }\n  webContents.canGoBack = function() {\n    return !!webview.canGoBack()\n  }\n  webContents.canGoForward = function() {\n    return !!webview.canGoForward()\n  }\n  webContents.canGoToOffset = function(offset) {\n    return !!webview.backForwardList().itemAtIndex(offset)\n  }\n  webContents.clearHistory = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.goBack = function() {\n    webview.goBack()\n  }\n  webContents.goForward = function() {\n    webview.goForward()\n  }\n  webContents.goToIndex = function(index) {\n    var backForwardList = webview.backForwardList()\n    var backList = backForwardList.backList()\n    var backListLength = backList.count()\n    if (backListLength > index) {\n      webview.loadRequest(NSURLRequest.requestWithURL(backList[index]))\n      return\n    }\n    var forwardList = backForwardList.forwardList()\n    if (forwardList.count() > index - backListLength) {\n      webview.loadRequest(\n        NSURLRequest.requestWithURL(forwardList[index - backListLength])\n      )\n      return\n    }\n    throw new Error('Cannot go to index ' + index)\n  }\n  webContents.goToOffset = function(offset) {\n    if (!webContents.canGoToOffset(offset)) {\n      throw new Error('Cannot go to offset ' + offset)\n    }\n    webview.loadRequest(\n      NSURLRequest.requestWithURL(webview.backForwardList().itemAtIndex(offset))\n    )\n  }\n  webContents.isCrashed = function() {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setUserAgent = function(/* userAgent */) {\n    // TODO:\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.getUserAgent = function() {\n    const userAgent = webview.customUserAgent()\n    return userAgent ? String(userAgent) : undefined\n  }\n  webContents.insertCSS = function(css) {\n    var source =\n      \"var style = document.createElement('style'); style.innerHTML = \" +\n      css.replace(/\"/, '\\\\\"') +\n      '; document.head.appendChild(style);'\n    var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n      source,\n      0,\n      true\n    )\n    webview\n      .configuration()\n      .userContentController()\n      .addUserScript(script)\n  }\n  webContents.insertJS = function(source) {\n    var script = WKUserScript.alloc().initWithSource_injectionTime_forMainFrameOnly(\n      source,\n      0,\n      true\n    )\n    webview\n      .configuration()\n      .userContentController()\n      .addUserScript(script)\n  }\n  webContents.executeJavaScript = executeJavaScript(webview, browserWindow)\n  webContents.setIgnoreMenuShortcuts = function() {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setAudioMuted = function(/* muted */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.isAudioMuted = function() {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setZoomFactor = function(factor) {\n    webview.setMagnification_centeredAtPoint(factor, CGPointMake(0, 0))\n  }\n  webContents.getZoomFactor = function(callback) {\n    callback(Number(webview.magnification()))\n  }\n  webContents.setZoomLevel = function(level) {\n    // eslint-disable-next-line no-restricted-properties\n    webContents.setZoomFactor(Math.pow(1.2, level))\n  }\n  webContents.getZoomLevel = function(callback) {\n    // eslint-disable-next-line no-restricted-properties\n    callback(Math.log(Number(webview.magnification())) / Math.log(1.2))\n  }\n  webContents.setVisualZoomLevelLimits = function(/* minimumLevel, maximumLevel */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n  webContents.setLayoutZoomLevelLimits = function(/* minimumLevel, maximumLevel */) {\n    // TODO:??\n    console.warn(\n      'Not implemented yet, please open a PR on https://github.com/skpm/sketch-module-web-view :)'\n    )\n  }\n\n  // TODO:\n  // webContents.undo = function() {\n  //   webview.undoManager().undo()\n  // }\n  // webContents.redo = function() {\n  //   webview.undoManager().redo()\n  // }\n  // webContents.cut = webview.cut\n  // webContents.copy = webview.copy\n  // webContents.paste = webview.paste\n  // webContents.pasteAndMatchStyle = webview.pasteAsRichText\n  // webContents.delete = webview.delete\n  // webContents.replace = webview.replaceSelectionWithText\n\n  webContents.send = function() {\n    const script =\n      'window.postMessage({' +\n      'isSketchMessage: true,' +\n      \"origin: '\" +\n      String(__command.identifier()) +\n      \"',\" +\n      'args: ' +\n      JSON.stringify([].slice.call(arguments)) +\n      '}, \"*\")'\n    webview.evaluateJavaScript_completionHandler(script, null)\n  }\n\n  webContents.getNativeWebview = function() {\n    return webview\n  }\n\n  browserWindow.webContents = webContents\n}\n","/* globals NSThread */\nvar threadDictionary = NSThread.mainThread().threadDictionary()\n\nmodule.exports.getWebview = function(identifier) {\n  return require('./lib').fromId(identifier) // eslint-disable-line\n}\n\nmodule.exports.isWebviewPresent = function isWebviewPresent(identifier) {\n  return !!threadDictionary[identifier]\n}\n\nmodule.exports.sendToWebview = function sendToWebview(identifier, evalString) {\n  if (!module.exports.isWebviewPresent(identifier)) {\n    return\n  }\n\n  var panel = threadDictionary[identifier]\n  var webview = null\n  var subviews = panel.contentView().subviews()\n  for (var i = 0; i < subviews.length; i += 1) {\n    if (\n      !webview &&\n      !subviews[i].isKindOfClass(WKInspectorWKWebView) &&\n      subviews[i].isKindOfClass(WKWebView)\n    ) {\n      webview = subviews[i]\n    }\n  }\n\n  if (!webview || !webview.evaluateJavaScript_completionHandler) {\n    throw new Error('Webview ' + identifier + ' not found')\n  }\n\n  webview.evaluateJavaScript_completionHandler(evalString, null)\n}\n","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/a89fb8235dde0492420c64edf7895f27.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/501a29759b7672b9b65a7f2a6ff5d6a3.html\";","module.exports = \"file://\" + String(context.scriptPath).split(\".sketchplugin/Contents/Sketch\")[0] + \".sketchplugin/Contents/Resources/_webpack_resources/4cb7f20f83b51bbc33cc98bf0996bcdc.html\";","import BrowserWindow from 'sketch-module-web-view';\nimport { getWebview } from 'sketch-module-web-view/remote';\nimport UI from 'sketch/ui';\nconst StylesHelpers = require(\"./StylesHelpers\");\nconst webviewIdentifier = 'assign-styles-automatically.webview';\nconst webviewRegIdentifier = 'assign-styles-automatically.webviewReg';\nconst Settings = require(\"./EditSettings\");\n\nvar globalTextLayers;\nvar globalByArtb;\nvar globalTriggeredAction = StylesHelpers.actionScope.DOCUMENT;\n\nvar globalRemainingDays = 0;\nvar globalIsInTrial = false;\nvar globalIsExpired = false;\nvar globalIsOver = false;\n\nexport function onHowStylerWorks(context) {\n  NSWorkspace.sharedWorkspace().openURL(NSURL.URLWithString(\"http://www.sketchstyler.com\"));\n}\n\nexport function onReportIssue(context) {\n  NSWorkspace.sharedWorkspace().openURL(NSURL.URLWithString(\"https://github.com/oodesign/sketch-styler/issues\"));\n}\n\nexport function onReportLicenseIssue() {\n  \n  var subject=encodeURI(\"License issues\");\n  var body=encodeURI(\"\\\nHi!\\\n\\n\\n\\\nLooks like something is not working properly with my Sketch Styler license.\\\n\\n\\n\\\nThis is the e-mail account I used to get my license on Gumroad:\\\n\\n\\\nAnd this is my license key:\\\n\\n\\n\\\nMay you please take a look and come back to me as soon as possible?\\\n\\n\\n\\\nThank you!\\\n  \");\n  NSWorkspace.sharedWorkspace().openURL(NSURL.URLWithString(\"mailto:licensing@oodesign.me?subject=\"+subject+\"&body=\"+body));\n}\n\nexport function onScanLayer(context) {\n\n  StylesHelpers.clog(\"----- Styler - Selected layer -----\");\n\n  StylesHelpers.LoadSettings();\n  StylesHelpers.analytics(\"ScanLayer\");\n  var isTextLayer = false;\n  if (context.selection.length === 1) {\n    var textLayer = context.selection.firstObject();\n    if (textLayer != null && textLayer.isKindOfClass(MSTextLayer)) {\n      isTextLayer = true;\n    }\n  }\n\n  if (isTextLayer) {\n    if (textLayer.sharedStyle() == null) {\n      globalTriggeredAction = StylesHelpers.actionScope.LAYER;\n      onValidate(context);\n    }\n    else {\n      UI.message(\"The selected text layer has already a style.\");\n    }\n  }\n  else {\n    UI.message(\"Selected element is not a text layer.\")\n  }\n\n\n}\n\nexport function onScanArtboard(context) {\n\n  StylesHelpers.clog(\"----- Styler - Selected artboard -----\");\n\n  StylesHelpers.LoadSettings();\n  StylesHelpers.analytics(\"ScanArtboard\");\n  var isArtboard = false;\n  if (context.selection.length === 1) {\n    var artboard = context.selection.firstObject();\n    if (artboard != null && artboard.isKindOfClass(MSArtboardGroup)) {\n      isArtboard = true;\n    }\n  }\n\n  if (isArtboard) {\n    globalTriggeredAction = StylesHelpers.actionScope.ARTBOARD;\n    onValidate(context);\n  }\n  else {\n    UI.message(\"Selected element is not an artboard.\")\n  }\n}\n\nexport function onScanPage(context) {\n\n  StylesHelpers.clog(\"----- Styler - Selected page -----\");\n\n  StylesHelpers.LoadSettings();\n  StylesHelpers.analytics(\"ScanPage\");\n  var isPageSearchable = false;\n  var page = context.document.currentPage();\n  if (page != null) isPageSearchable = true;\n\n  if (isPageSearchable) {\n    globalTriggeredAction = StylesHelpers.actionScope.PAGE;\n    onValidate(context);\n  }\n  else {\n    UI.message(\"Looks like there is no active page at the moment...\");\n  }\n}\n\nexport function onScanDocument(context) {\n\n  StylesHelpers.clog(\"----- Styler - Whole document -----\");\n\n  StylesHelpers.LoadSettings();\n  StylesHelpers.analytics(\"ScanDocument\");\n  globalTriggeredAction = StylesHelpers.actionScope.DOCUMENT;\n  onValidate(context);\n}\n\nexport function EditSettings(context) {\n  StylesHelpers.LoadSettings();\n  Settings.EditSettings(context);\n};\n\n//d9-01\nvar _0xd76e = [\"\\x61\\x70\\x70\", \"\\x76\\x61\\x6C\\x53\\x74\\x61\\x74\\x75\\x73\", \"\\x6F\\x76\\x65\\x72\", \"\\x6E\\x6F\\x77\", \"\\x61\\x62\\x73\", \"\\x66\\x6C\\x6F\\x6F\\x72\"]; export function onValidate(_0xb471x2) { var _0xb471x3 = StylesHelpers.ExiGuthrie(); if (_0xb471x3 == StylesHelpers[_0xd76e[1]][_0xd76e[0]]) { scanTextLayers(_0xb471x2) } else { if (_0xb471x3 == StylesHelpers[_0xd76e[1]][_0xd76e[2]]) { globalIsOver = true; showRegistration(_0xb471x2) } else { var _0xb471x4 = StylesHelpers.IsInTrial(); var _0xb471x5 = new Date(parseInt(_0xb471x4)); if (_0xb471x4 != null) { var _0xb471x6 = _0xb471x5 - Date[_0xd76e[3]](); var _0xb471x7 = Math[_0xd76e[5]](Math[_0xd76e[4]](_0xb471x6 / (1000 * 3600 * 24))); globalRemainingDays = 7 - _0xb471x7; if (globalRemainingDays > 0) { globalIsInTrial = true } else { globalIsExpired = true }; showRegistration(_0xb471x2) } else { showRegistration(_0xb471x2) } } } }\n\nexport function showRegistration(context) {\n\n  var options = {\n    identifier: webviewRegIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    titleBarStyle: 'hidden'\n  }\n\n  var regWindow = new BrowserWindow(options)\n\n  const webContentsReg = regWindow.webContents;\n\n  //d9-02\n  var _0xbf12 = [\"\\x72\\x65\\x61\\x64\\x79\\x2D\\x74\\x6F\\x2D\\x73\\x68\\x6F\\x77\", \"\\x65\\x72\\x72\\x6F\\x72\", \"\\x63\\x61\\x74\\x63\\x68\", \"\\x53\\x65\\x74\\x54\\x72\\x69\\x61\\x6C\\x4D\\x6F\\x64\\x65\\x28\", \"\\x73\\x74\\x72\\x69\\x6E\\x67\\x69\\x66\\x79\", \"\\x29\", \"\\x65\\x78\\x65\\x63\\x75\\x74\\x65\\x4A\\x61\\x76\\x61\\x53\\x63\\x72\\x69\\x70\\x74\", \"\\x53\\x65\\x74\\x45\\x78\\x70\\x69\\x72\\x65\\x64\\x4D\\x6F\\x64\\x65\\x28\\x29\", \"\\x53\\x65\\x74\\x4F\\x76\\x65\\x72\\x4D\\x6F\\x64\\x65\\x28\\x29\", \"\\x73\\x68\\x6F\\x77\", \"\\x6F\\x6E\\x63\\x65\", \"\\x64\\x69\\x64\\x2D\\x66\\x69\\x6E\\x69\\x73\\x68\\x2D\\x6C\\x6F\\x61\\x64\", \"\\x6F\\x6E\", \"\\x52\\x65\\x67\\x69\\x73\\x74\\x65\\x72\\x4B\\x65\\x79\", \"\\x61\\x70\\x70\", \"\\x76\\x61\\x6C\\x53\\x74\\x61\\x74\\x75\\x73\", \"\", \"\\x70\\x61\\x74\\x68\", \"\\x6D\\x61\\x69\\x6E\\x50\\x6C\\x75\\x67\\x69\\x6E\\x73\\x46\\x6F\\x6C\\x64\\x65\\x72\\x55\\x52\\x4C\", \"\\x2F\\x53\\x74\\x79\\x6C\\x65\\x4D\\x65\\x2E\\x6A\\x73\\x6F\\x6E\", \"\\x77\\x72\\x69\\x74\\x65\\x54\\x65\\x78\\x74\\x54\\x6F\\x46\\x69\\x6C\\x65\", \"\\x53\\x68\\x6F\\x77\\x52\\x65\\x67\\x69\\x73\\x74\\x72\\x61\\x74\\x69\\x6F\\x6E\\x43\\x6F\\x6D\\x70\\x6C\\x65\\x74\\x65\\x28\\x29\", \"\\x6F\\x76\\x65\\x72\", \"\\x53\\x65\\x74\\x4F\\x76\\x65\\x72\\x4D\\x6F\\x64\\x65\\x49\\x6E\\x52\\x65\\x67\\x28\\x29\", \"\\x53\\x68\\x6F\\x77\\x52\\x65\\x67\\x69\\x73\\x74\\x72\\x61\\x74\\x69\\x6F\\x6E\\x46\\x61\\x69\\x6C\\x28\\x29\", \"\\x53\\x74\\x61\\x72\\x74\\x54\\x72\\x69\\x61\\x6C\", \"\\x6E\\x6F\\x77\", \"\\x53\\x68\\x6F\\x77\\x54\\x72\\x69\\x61\\x6C\\x53\\x74\\x61\\x72\\x74\\x65\\x64\\x28\\x29\", \"\\x43\\x6F\\x6E\\x74\\x69\\x6E\\x75\\x65\\x54\\x72\\x69\\x61\\x6C\", \"\\x4C\\x65\\x74\\x73\\x53\\x74\\x61\\x72\\x74\\x54\\x72\\x69\\x61\\x6C\", \"\\x4C\\x65\\x74\\x73\\x53\\x74\\x61\\x72\\x74\"]; regWindow[_0xbf12[10]](_0xbf12[0], () => { if (globalIsInTrial) { webContentsReg[_0xbf12[6]]((_0xbf12[3] + (JSON[_0xbf12[4]](globalRemainingDays)) + _0xbf12[5]))[_0xbf12[2]](console[_0xbf12[1]]) }; if (globalIsExpired) { webContentsReg[_0xbf12[6]](_0xbf12[7])[_0xbf12[2]](console[_0xbf12[1]]) }; if (globalIsOver) { webContentsReg[_0xbf12[6]](_0xbf12[8])[_0xbf12[2]](console[_0xbf12[1]]) }; regWindow[_0xbf12[9]]() }); webContentsReg[_0xbf12[12]](_0xbf12[11], () => { if (globalIsInTrial) { webContentsReg[_0xbf12[6]]((_0xbf12[3] + (JSON[_0xbf12[4]](globalRemainingDays)) + _0xbf12[5]))[_0xbf12[2]](console[_0xbf12[1]]) }; if (globalIsExpired) { webContentsReg[_0xbf12[6]](_0xbf12[7])[_0xbf12[2]](console[_0xbf12[1]]) }; if (globalIsOver) { webContentsReg[_0xbf12[6]](_0xbf12[8])[_0xbf12[2]](console[_0xbf12[1]]) } }); webContentsReg[_0xbf12[12]](_0xbf12[13], (_0x875bx1) => { var _0x875bx2 = StylesHelpers.Guthrie(_0x875bx1, true); if (_0x875bx2 == StylesHelpers[_0xbf12[15]][_0xbf12[14]]) { var _0x875bx3 = { \"\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x4B\\x65\\x79\": _0xbf12[16] + _0x875bx1 }; StylesHelpers[_0xbf12[20]](_0x875bx3, MSPluginManager[_0xbf12[18]]()[_0xbf12[17]]() + _0xbf12[19]); webContentsReg[_0xbf12[6]](_0xbf12[21])[_0xbf12[2]](console[_0xbf12[1]]) } else { if (_0x875bx2 == StylesHelpers[_0xbf12[15]][_0xbf12[22]]) { webContentsReg[_0xbf12[6]](_0xbf12[8])[_0xbf12[2]](console[_0xbf12[1]]); webContentsReg[_0xbf12[6]](_0xbf12[23])[_0xbf12[2]](console[_0xbf12[1]]) } else { webContentsReg[_0xbf12[6]](_0xbf12[24])[_0xbf12[2]](console[_0xbf12[1]]) } } }); webContentsReg[_0xbf12[12]](_0xbf12[25], (_0x875bx1) => { var _0x875bx4 = { \"\\x73\\x74\\x61\\x72\\x74\\x54\\x69\\x6D\\x65\": _0xbf12[16] + Date[_0xbf12[26]]() }; StylesHelpers[_0xbf12[20]](_0x875bx4, MSPluginManager[_0xbf12[18]]()[_0xbf12[17]]() + _0xbf12[19]); webContentsReg[_0xbf12[6]](_0xbf12[27])[_0xbf12[2]](console[_0xbf12[1]]) }); webContentsReg[_0xbf12[12]](_0xbf12[28], () => { onShutdown(webviewRegIdentifier); scanTextLayers(context) }); webContentsReg[_0xbf12[12]](_0xbf12[29], () => { globalIsInTrial = true; globalRemainingDays = 7; onShutdown(webviewRegIdentifier); scanTextLayers(context) }); webContentsReg[_0xbf12[12]](_0xbf12[30], () => { globalIsInTrial = false; onShutdown(webviewRegIdentifier); scanTextLayers(context) })\n\n\n  webContentsReg.on('nativeLog', s => {\n    StylesHelpers.clog(s);\n  })\n\n  webContentsReg.on('OpenStylerWeb', s => {\n    NSWorkspace.sharedWorkspace().openURL(NSURL.URLWithString(\"http://www.sketchstyler.com\"));\n  })\n\n  webContentsReg.on('Cancel', () => {\n    onShutdown(webviewRegIdentifier);\n  });\n\n  regWindow.loadURL(require('../resources/register.html'));\n}\n\nexport function scanTextLayers(context) {\n\n  StylesHelpers.clog(\"Scanning layers\");\n\n  const options = {\n    identifier: webviewIdentifier,\n    width: 1200,\n    height: 700,\n    show: false,\n    titleBarStyle: 'hidden'\n  }\n\n  const browserWindow = new BrowserWindow(options)\n\n\n  // only show the window when the page has loaded to avoid a white flash\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  const webContents = browserWindow.webContents\n\n  // print a message when the page loads\n  webContents.on('did-finish-load', () => {\n    //UI.message('UI loaded!')\n\n    StylesHelpers.clog(\"Web UI loaded\");\n    var libraries = NSApp.delegate().librariesController().libraries();\n    var activeLibraries = []\n    StylesHelpers.clog(\"Adding linked libraries\");\n    libraries.forEach(function (lib) {\n      if (lib.enabled()) {\n        activeLibraries.push({\n          \"name\": \"\" + lib.name(),\n          \"libraryID\": \"\" + lib.libraryID(),\n          \"checked\": StylesHelpers.getLibrariesEnabled()\n        });\n      }\n    });\n    if (globalIsInTrial)\n      webContents.executeJavaScript(`SetWindowTitle(${JSON.stringify(globalRemainingDays)})`).catch(console.error);\n\n\n    StylesHelpers.clog(\"Drawing linked libraries\");\n    webContents.executeJavaScript(`DrawActiveLibraries(${JSON.stringify(activeLibraries)})`).catch(console.error);\n\n  })\n\n  // add a handler for a call from web content's javascript\n  webContents.on('nativeLog', s => {\n    StylesHelpers.clog(s);\n  })\n\n\n  webContents.on('GetThumbnail', (layerID, matchingStyleIndex, markupLayerID) => {\n    StylesHelpers.clog(\"GetThumbnail for layer:\" + layerID);\n    var index = StylesHelpers.indexOfTextLayer(globalTextLayers, layerID);\n    var thumbnail = StylesHelpers.getTextStyleDummyThumbnail(context, globalTextLayers[index].matchingStyles[matchingStyleIndex].textStyle.style(), globalTextLayers[index].textLayer, globalTextLayers[index].textLayer.stringValue());\n    webContents.executeJavaScript(`DrawStyleThumbnail(${JSON.stringify(thumbnail)}, ${JSON.stringify(markupLayerID)})`).catch(console.error);\n  });\n\n\n\n  webContents.on('GetMeAStyle', (checkSameFont, checkSameWeight, includeSimilarWeights, checkSameSize, includeSimilarSize, checkSameColor, includeSimilarColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing, checkedActiveLibraries) => {\n\n    StylesHelpers.clog(\"Getting a style\");\n\n    globalTextLayers = [];\n    var unstyledTextLayers = [];\n    var message = \"Looking for matching styles\";\n\n    var textStyles = StylesHelpers.getDefinedTextStyles(context, checkedActiveLibraries);\n    var allTextLayers = StylesHelpers.getAllTextLayers(context, true, globalTriggeredAction);\n\n    if ((allTextLayers.length > 50) && (textStyles.length > 20)) message = \"Looking for matching styles. This may take a minute...\";\n    if (textStyles.length > 50) message = \"Looking for matching styles. This may take a minute...\";\n    if ((allTextLayers.length > 100) && (textStyles.length > 50)) message = \"Wow! \" + allTextLayers.length + \" unstyled layers and \" + textStyles.length + \" styles! We're pairing texts and styles, but this may take some minutes. You may better go get some coffee?\";\n    if (textStyles.length > 100) message = \"Wow! \" + allTextLayers.length + \" unstyled layers and \" + textStyles.length + \" styles!!! We're pairing texts and styles, but this may take some minutes. You may better go get some coffee?\";\n\n    webContents.executeJavaScript(`ShowProgress(${JSON.stringify(message)})`).catch(console.error);\n\n    var stylesArranged = StylesHelpers.getStylesArranged(textStyles, context, checkSameFont, checkSameWeight, includeSimilarWeights, checkSameSize, includeSimilarSize, checkSameColor, includeSimilarColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing);\n    StylesHelpers.clog(\"Collected arranged styles (\" + stylesArranged.length + \")\");\n\n    var totalmatchingstyles = 0;\n    StylesHelpers.clog(\"Total text layers:\" + allTextLayers.length);\n    for (var i = 0; i < allTextLayers.length; i++) {\n\n      var matchingStylesWithArranged = StylesHelpers.findMatchInArranged(allTextLayers[i], stylesArranged, checkSameFont, checkSameWeight, includeSimilarWeights, checkSameSize, includeSimilarSize, checkSameColor, includeSimilarColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing);\n\n      StylesHelpers.clog(\"Found matching arranged styles:\" + matchingStylesWithArranged.length);\n      if (matchingStylesWithArranged.length > 0) {\n        var layerThumbnail = StylesHelpers.getBase64(allTextLayers[i], allTextLayers[i].frame().width(), allTextLayers[i].frame().height());\n        globalTextLayers.push({\n          \"textLayer\": allTextLayers[i],\n          \"layerID\": allTextLayers[i].objectID(),\n          \"matchingStyles\": matchingStylesWithArranged\n        });\n\n        var matchingStyles = {};\n        matchingStyles['matchingStyles'] = [];\n        for (var j = 0; j < matchingStylesWithArranged.length; j++) {\n          var thumbnail;\n          if (j == 0)\n            thumbnail = StylesHelpers.getTextStyleDummyThumbnail(context, matchingStylesWithArranged[j].textStyle.style(), allTextLayers[i], allTextLayers[i].stringValue());\n          else\n            thumbnail = null;\n\n\n          var sendColor = \"Couldn't load color\";\n          var contrastBackground = false;\n          if (matchingStylesWithArranged[j].textStyle.style().textStyle().attributes().MSAttributedStringColorAttribute != null) {\n            sendColor = \"#\" + matchingStylesWithArranged[j].textStyle.style().textStyle().attributes().MSAttributedStringColorAttribute.hexValue();\n            contrastBackground = StylesHelpers.shouldEnableContrastMode(sendColor);\n          }\n\n\n\n\n          matchingStyles['matchingStyles'].push({\n            \"styleName\": \"\" + matchingStylesWithArranged[j].name,\n            \"textStyle\": matchingStylesWithArranged[j].textStyle,\n            \"thumbnail\": thumbnail,\n            \"contrastBackground\": contrastBackground,\n            \"fontName\": \"\" + matchingStylesWithArranged[j].textStyle.style().textStyle().attributes().NSFont.familyName(),\n            \"fontSize\": \"\" + matchingStylesWithArranged[j].textStyle.style().textStyle().attributes().NSFont.pointSize() + \"pt\",\n            \"color\": sendColor,\n          });\n\n\n          totalmatchingstyles++;\n        }\n\n\n        var styleLoaded = 0;\n\n        var sendLayerColor = \"Couldn't load color\";\n        var sendFontName = \"Couldn't gather font name\";\n        var sendFontSize = \"Couldn't gather font size\";\n        var sendContrast = false;\n\n\n\n\n        if (StylesHelpers.firstCheckForStyle(allTextLayers[i])) {\n          sendFontName = \"\" + allTextLayers[i].style().textStyle().attributes().NSFont.familyName();\n          sendFontSize = \"\" + allTextLayers[i].style().textStyle().attributes().NSFont.pointSize() + \"pt\";\n          if (allTextLayers[i].style().textStyle().attributes().MSAttributedStringColorAttribute != null) {\n            sendLayerColor = \"#\" + allTextLayers[i].style().textStyle().attributes().MSAttributedStringColorAttribute.hexValue();\n            sendContrast = StylesHelpers.shouldEnableContrastMode(allTextLayers[i].style().textStyle().attributes().MSAttributedStringColorAttribute.hexValue().toString());\n          }\n        }\n\n\n        StylesHelpers.clog(\"Adding unstyled text layer:\" + allTextLayers[i].name() + \" (in \" + allTextLayers[i].parentArtboard().name() + \"), that has \" + matchingStyles['matchingStyles'].length + \" similar styles\");\n\n\n        unstyledTextLayers.push({\n          \"layerID\": \"\" + allTextLayers[i].objectID(),\n          \"isSmall\": ((allTextLayers[i].frame().width() > 2000) || (allTextLayers[i].frame().height() < 28) || (allTextLayers[i].frame().height() > 100)),\n          \"contrastBackground\": sendContrast,\n          \"textLayer\": allTextLayers[i],\n          \"name\": \"\" + allTextLayers[i].name(),\n          \"artboardID\": \"\" + allTextLayers[i].parentArtboard().objectID(),\n          \"artboardName\": \"\" + allTextLayers[i].parentArtboard().name(),\n          \"displayText\": allTextLayers[i].stringValue(),\n          \"thumbnail\": layerThumbnail,\n          \"matchingStyles\": matchingStyles,\n          \"styleLoaded\": styleLoaded,\n          \"assignStyle\": true,\n          \"fontName\": sendFontName,\n          \"fontSize\": sendFontSize,\n          \"color\": sendLayerColor,\n        });\n      }\n\n      var percent = i / allTextLayers.length;\n      webContents.executeJavaScript(`UpdateProgress(${JSON.stringify(percent)})`).catch(console.error);\n\n    }\n\n    const groupByArtboard = groupBy('artboardID');\n    var byArtb = groupByArtboard(unstyledTextLayers);\n\n\n    //console.timeEnd('GetMeAStyle');\n    globalByArtb = byArtb;\n\n    var targetProgress = 100;\n    webContents.executeJavaScript(`HideProgress(${targetProgress})`).catch(console.error);\n\n    var layersWithNoMatches = (allTextLayers.length - unstyledTextLayers.length);\n    StylesHelpers.clog(\"Text layers to style: \" + unstyledTextLayers.length + \". Total matching styles: \" + totalmatchingstyles + \". Total layers with no matches styles: \" + (allTextLayers.length - unstyledTextLayers.length));\n    webContents.executeJavaScript(`DrawElements(${JSON.stringify(byArtb)},${unstyledTextLayers.length}, ${layersWithNoMatches})`).catch(console.error);\n  });\n\n\n  const groupBy = key => array =>\n    array.reduce((objectsByKeyValue, obj) => {\n      const value = obj[key];\n      objectsByKeyValue[value] = (objectsByKeyValue[value] || []).concat(obj);\n      return objectsByKeyValue;\n    }, {});\n\n  webContents.on('AssignStyles', (byArtb) => {\n    StylesHelpers.clog(\"Assigning Styles to layers\");\n    var stylesAsigned = 0;\n    for (var artboard in globalByArtb) {\n      var glob_unstyledTextLayers = globalByArtb[artboard];\n      var ref_unstyledTextLayers = byArtb[artboard];\n\n      for (var i = 0; i < glob_unstyledTextLayers.length; i++) {\n        var textLayer = glob_unstyledTextLayers[i].textLayer;\n        if (ref_unstyledTextLayers[i].assignStyle) {\n          if (ref_unstyledTextLayers[i].styleLoaded == -1) {\n            StylesHelpers.clog(\"Looks like text layer '\" + textLayer.name() + \"' doesn't have any similar style to be applied\");\n          }\n          else {\n            StylesHelpers.clog(\"We're gonna give '\" + textLayer.name() + \"' style '\" + glob_unstyledTextLayers[i].matchingStyles['matchingStyles'][ref_unstyledTextLayers[i].styleLoaded].textStyle.name() + \"'\");\n            textLayer.setSharedStyle(glob_unstyledTextLayers[i].matchingStyles['matchingStyles'][ref_unstyledTextLayers[i].styleLoaded].textStyle);\n            stylesAsigned++;\n          }\n        }\n        else {\n          StylesHelpers.clog(\"Not styling layer \" + textLayer.name + \" because we were told not to do so\");\n        }\n      }\n    }\n\n    onShutdown(webviewIdentifier);\n\n    UI.message(\"Hey ho! \" + stylesAsigned + \" layers now have a cool shiny style!\");\n\n  });\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewIdentifier);\n  });\n\n  browserWindow.loadURL(require('../resources/webview.html'))\n}\n\n\nexport function onShutdown(webviewID) {\n  const existingWebview = getWebview(webviewID)\n  if (existingWebview) {\n    existingWebview.close()\n  }\n}\n\n\n\n","import BrowserWindow from 'sketch-module-web-view'\nimport { getWebview } from 'sketch-module-web-view/remote'\nconst Helpers = require(\"./StylesHelpers\");\nconst webviewEsIdentifier = 'assign-styles-automatically.webviewSettings';\n\nvar globalSettingsFile;\n\nexport function EditSettings(context) {\n  const optionss = {\n    identifier: webviewEsIdentifier,\n    width: 500,\n    height: 600,\n    show: false,\n    remembersWindowFrame: true,\n    titleBarStyle: 'hidden'\n  }\n  const browserWindow = new BrowserWindow(optionss);\n  const webContents = browserWindow.webContents;\n\n\n  browserWindow.loadURL(require('../resources/settings.html'));\n  globalSettingsFile = Helpers.getSettings();\n\n  browserWindow.once('ready-to-show', () => {\n    browserWindow.show()\n  })\n\n  webContents.on('did-finish-load', () => {\n    webContents.executeJavaScript(`AssignSettings(${Helpers.getLogsEnabled()},${Helpers.getLibrariesEnabled()})`).catch(console.error);\n  })\n\n  webContents.on('nativeLog', s => {\n    Helpers.clog(s);\n  });\n\n  webContents.on('Cancel', () => {\n    onShutdown(webviewEsIdentifier);\n  });\n\n  webContents.on('AcceptSettings', (logsEnabled, librariesEnabledByDefault) => {\n    //d9-06\n    var _0xeafa=[\"\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x4B\\x65\\x79\",\"\",\"\\x73\\x74\\x61\\x72\\x74\\x54\\x69\\x6D\\x65\",\"\\x70\\x61\\x74\\x68\",\"\\x6D\\x61\\x69\\x6E\\x50\\x6C\\x75\\x67\\x69\\x6E\\x73\\x46\\x6F\\x6C\\x64\\x65\\x72\\x55\\x52\\x4C\",\"\\x2F\\x53\\x74\\x79\\x6C\\x65\\x4D\\x65\\x2E\\x6A\\x73\\x6F\\x6E\",\"\\x77\\x72\\x69\\x74\\x65\\x54\\x65\\x78\\x74\\x54\\x6F\\x46\\x69\\x6C\\x65\"];var jsonDef;if((globalSettingsFile!= null)&& (globalSettingsFile[_0xeafa[0]]!= null)){jsonDef= {\"\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x4B\\x65\\x79\":_0xeafa[1]+ globalSettingsFile[_0xeafa[0]],\"\\x6C\\x6F\\x67\\x73\":logsEnabled,\"\\x6C\\x69\\x62\\x72\\x61\\x72\\x69\\x65\\x73\\x45\\x6E\\x61\\x62\\x6C\\x65\\x64\\x42\\x79\\x44\\x65\\x66\\x61\\x75\\x6C\\x74\":librariesEnabledByDefault}}else {if((globalSettingsFile!= null)&& (globalSettingsFile[_0xeafa[2]]!= null)){jsonDef= {\"\\x73\\x74\\x61\\x72\\x74\\x54\\x69\\x6D\\x65\":_0xeafa[1]+ globalSettingsFile[_0xeafa[2]],\"\\x6C\\x6F\\x67\\x73\":logsEnabled,\"\\x6C\\x69\\x62\\x72\\x61\\x72\\x69\\x65\\x73\\x45\\x6E\\x61\\x62\\x6C\\x65\\x64\\x42\\x79\\x44\\x65\\x66\\x61\\x75\\x6C\\x74\":librariesEnabledByDefault}}};Helpers[_0xeafa[6]](jsonDef,MSPluginManager[_0xeafa[4]]()[_0xeafa[3]]()+ _0xeafa[5]);onShutdown(webviewEsIdentifier)\n    //d9-06\n  });\n}\n\nexport function onShutdown(webviewID) {\n  const existingWebview = getWebview(webviewID)\n  if (existingWebview) {\n    existingWebview.close()\n  }\n}","var DeltaE = require('delta-e');\nvar D3 = require('d3-color');\nvar fs = require('@skpm/fs');\n// var track = require(\"sketch-module-google-analytics\");\n\nconst stylePrecision = {\n  EXACT: 'exact',\n  SIMILAR: 'similar'\n}\n\nconst actionScope = {\n  LAYER: 'layer',\n  ARTBOARD: 'artboard',\n  PAGE: 'page',\n  DOCUMENT: 'document',\n}\n\nconst valStatus = {\n  app: 'app',\n  no: 'no',\n  over: 'over'\n}\n\nconst similarFontSizeThreshold = 0.1;\nconst similarFontWeightThreshold = 2;\nconst similarColorDeltaEThreshold = 45;\n\nvar settingsFile;\nvar logsEnabled = false;\nvar librariesEnabledByDefault = true;\n\nfunction getDefinedTextStyles(context, checkedActiveLibraries) {\n  var textStyles = [];\n  var localTextStyles = context.document.documentData().layerTextStyles().objects();\n\n  clog(\"Local text styles:\" + context.document.documentData().layerTextStyles().objects().count());\n\n  for (var i = 0; i < localTextStyles.count(); i++) {\n    var style = localTextStyles.objectAtIndex(i);\n\n    textStyles.push({\n      \"textStyle\": style,\n      \"name\": style.name(),\n      \"libraryName\": \"local\",\n      \"foreign\": false\n    });\n  }\n\n  clog(\"Foreign text styles:\" + context.document.documentData().foreignTextStyles().count());\n\n  context.document.documentData().foreignTextStyles().forEach(style => {\n    var attributes = style.localObject().style().textStyle().attributes();\n\n    var indexOfForeign = indexOfForeignStyle(textStyles, style);\n\n    if (indexOfForeign == -1) {\n\n      textStyles.push({\n        \"originalStyle\": style,\n        \"attributes\": attributes,\n        \"textStyle\": style.localObject(),\n        \"name\": style.localObject().name() + \"(Lib)\",\n        \"libraryName\": style.sourceLibraryName(),\n        \"foreign\": true,\n        \"localShareID\": style.localShareID(),\n        \"remoteShareID\": style.remoteShareID(),\n        \"correlativeStyles\": []\n      });\n    }\n    else {\n      clog(\"Should add as correlative at style \" + indexOfForeign + \" (\" + textStyles[indexOfForeign].name + \")\")\n      textStyles[indexOfForeign].correlativeStyles.push(style);\n    }\n  });\n\n\n\n  var includeExternalLibraries = false;\n  for (var i = 0; i < checkedActiveLibraries.length; i++) {\n    clog(checkedActiveLibraries[i].name + \" is \" + checkedActiveLibraries[i].checked);\n    if (checkedActiveLibraries[i].checked) {\n      includeExternalLibraries = true;\n      //break;\n    }\n  }\n\n  if (includeExternalLibraries) {\n\n    clog(\"Processing Libraries\");\n\n    var libraries = NSApp.delegate().librariesController().libraries();\n\n    libraries.forEach(function (lib) {\n      if (lib.enabled()) {\n        var libraryIndex = indexOfIncludedLibrary(checkedActiveLibraries, lib.libraryID());\n        if ((libraryIndex >= 0) && (checkedActiveLibraries[libraryIndex].checked)) {\n          clog(\"-- Processing styles for library: \" + lib.name() + \" - \" + lib.document().layerTextStyles().objects().count() + \" styles\");\n          lib.document().layerTextStyles().objects().forEach(function (libraryStyle) {\n            if (!alreadyInList(textStyles, libraryStyle)) {\n              var attributes = libraryStyle.style().textStyle().attributes();\n              clog(\"-- Including library style: \" + libraryStyle.name() + \"(\" + lib.name() + \")\");\n              textStyles.push({\n                \"textStyle\": libraryStyle,\n                \"attributes\": attributes,\n                \"name\": libraryStyle.name() + \"(\" + lib.name() + \")\",\n                \"libraryName\": lib.name(),\n                \"foreign\": true,\n                \"library\": lib\n              });\n            }\n          });\n        }\n      }\n    });\n  }\n\n  clog(\"Sorting textStyles\");\n  textStyles = textStyles.sort(compareStyleArrays);\n\n\n  return textStyles;\n}\n\n\nfunction alreadyInList(array, style) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i].originalStyle != null) {\n      if (array[i].originalStyle.remoteShareID().localeCompare(style.objectID()) == 0) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\n\nfunction getTextStyleDummyThumbnail(context, style, textLayer, suggestedString) {\n  var layer = MSTextLayer.new();\n  var width = textLayer.frame().width();\n  var height = textLayer.frame().height();\n\n\n  if (suggestedString != null)\n    layer.stringValue = suggestedString;\n  else\n    layer.stringValue = \"The quick brown fox\";\n\n  layer.style = style;\n\n  context.document.currentPage().addLayer(layer);\n  layer.frame().setWidth(width);\n  layer.frame().setHeight(height);\n  layer.setTextBehaviour(textLayer.textBehaviour());\n\n  var image = getThumbnail(layer, width, height);\n  var base64 = \"\" + getNSImageData(image);\n\n  layer.removeFromParent();\n  context.document.reloadInspector();\n\n  return base64;\n}\n\nfunction getThumbnail(element, width, height) {\n  var exportRequest = MSExportRequest.exportRequestsFromExportableLayer_inRect_useIDForName_(\n    element,\n    element.absoluteInfluenceRect(),\n    false\n  ).firstObject();\n\n  exportRequest.format = \"png\"\n\n\n  var scaleX = width / exportRequest.rect().size.width;\n  var scaleY = height / exportRequest.rect().size.height;\n\n  if (scaleX < scaleY)\n    exportRequest.scale = scaleX;\n  else\n    exportRequest.scale = scaleY;\n\n  var colorSpace = NSColorSpace.sRGBColorSpace()\n  var exporter = MSExporter.exporterForRequest_colorSpace_(exportRequest, colorSpace)\n  var imageRep = exporter.bitmapImageRep()\n\n  var image = NSImage.alloc().init().autorelease();\n  image.addRepresentation(imageRep);\n\n  return image;\n}\n\nfunction getBase64(element, width, height) {\n  var image = getThumbnail(element, width, height);\n  return \"\" + getNSImageData(image);\n}\n\nfunction compareStyleArrays(a, b) {\n  if (a.name < b.name) {\n    return -1;\n  }\n  if (a.name > b.name) {\n    return 1;\n  }\n  return 0;\n}\n\nfunction shouldEnableContrastMode(color) {\n  var UI = require('sketch/ui');\n  var theme = UI.getTheme();\n\n  var labReferenceColor = D3.lab(\"#\" + color);\n  var labComparisonColor;\n  if (theme === 'dark') {\n    labComparisonColor = D3.lab(\"#212124\");\n  } else {\n    labComparisonColor = D3.lab(\"#F9F9F9\");\n  }\n\n  var color1 = { L: labReferenceColor.l, A: labReferenceColor.a, B: labReferenceColor.b };\n  var color2 = { L: labComparisonColor.l, A: labComparisonColor.a, B: labComparisonColor.b };\n\n  var deltaE = DeltaE.getDeltaE76(color1, color2);\n\n  if (parseFloat(deltaE) < 30) {\n    return true;\n  }\n  else\n    return false;\n}\n\nfunction getImageData64(data) {\n  var imageData = data;\n  var mimeType = \"image/png\";\n  return NSString.stringWithFormat(\n    \"data:%@;base64,%@\",\n    mimeType,\n    imageData.base64EncodedStringWithOptions(0)\n  );\n}\nfunction getNSImageData(nsImage) {\n  var data = nsImage\n  var cgRef = nsImage.CGImageForProposedRect_context_hints(null, nil, nil);\n  var newRep = NSBitmapImageRep.alloc().initWithCGImage(cgRef);\n  newRep.setSize(nsImage.size());   // if you want the same resolution\n  var pngData = newRep.representationUsingType_properties(NSPNGFileType, nil);\n  return getImageData64(pngData)\n}\n\nfunction getTextLayerLayer(context, onlyUnstyledTexts) {\n  clog(\"Getting specific text layer\");\n  var layers = NSMutableArray.array();\n\n  var textLayer = context.selection.firstObject();\n\n  if (onlyUnstyledTexts) {\n    if (textLayer.sharedStyle() == null)\n      layers.addObject(textLayer);\n  }\n  else\n    layers.addObject(textLayer);\n\n  return layers;\n}\n\nfunction getDocumentLayers(context, onlyUnstyledTexts) {\n  clog(\"Getting document layers\");\n  var layers = NSMutableArray.array();\n\n  context.document.pages().forEach(function (page) {\n    page.children().forEach(function (layer) {\n      if ((layer.className() == \"MSSymbolMaster\") || (layer.className() == \"MSArtboardGroup\")) {\n        var predicate = NSPredicate.predicateWithFormat(\"className == 'MSTextLayer'\"),\n          instances = layer.children().filteredArrayUsingPredicate(predicate),\n          instanceLoop = instances.objectEnumerator(),\n          instance;\n\n        while (instance = instanceLoop.nextObject()) {\n          if (onlyUnstyledTexts) {\n            if (instance.sharedStyle() == null)\n              layers.addObject(instance);\n          }\n          else\n            layers.addObject(instance);\n        }\n\n      }\n    });\n  });\n\n  return layers;\n}\n\nfunction getArtboardLayers(context, onlyUnstyledTexts) {\n\n  clog(\"Getting artboard layers\");\n  var layers = NSMutableArray.array();\n  var artboard = context.selection.firstObject();\n\n  artboard.children().forEach(function (layer) {\n    if (layer.isKindOfClass(MSTextLayer)) {\n      if (onlyUnstyledTexts) {\n        if (layer.sharedStyle() == null)\n          layers.addObject(layer);\n      }\n      else\n        layers.addObject(layer);\n    }\n  });\n\n  return layers;\n}\n\nfunction getPageLayers(context, onlyUnstyledTexts) {\n  clog(\"Getting page layers\");\n  var layers = NSMutableArray.array();\n\n  var page = context.document.currentPage();\n  if (page != null) {\n    page.children().forEach(function (layer) {\n      if ((layer.className() == \"MSSymbolMaster\") || (layer.className() == \"MSArtboardGroup\")) {\n        var predicate = NSPredicate.predicateWithFormat(\"className == 'MSTextLayer'\"),\n          instances = layer.children().filteredArrayUsingPredicate(predicate),\n          instanceLoop = instances.objectEnumerator(),\n          instance;\n\n        while (instance = instanceLoop.nextObject()) {\n          if (onlyUnstyledTexts) {\n            if (instance.sharedStyle() == null)\n              layers.addObject(instance);\n          }\n          else\n            layers.addObject(instance);\n        }\n\n      }\n    });\n  }\n\n  return layers;\n}\n\nfunction getAllTextLayers(context, onlyUnstyledTexts, triggeredAction) {\n\n  var layers = NSMutableArray.array();\n  switch (triggeredAction) {\n    case actionScope.LAYER:\n      layers = getTextLayerLayer(context, onlyUnstyledTexts);\n      break;\n    case actionScope.ARTBOARD:\n      layers = getArtboardLayers(context, onlyUnstyledTexts);\n      break;\n    case actionScope.PAGE:\n      layers = getPageLayers(context, onlyUnstyledTexts);\n      break;\n    case actionScope.DOCUMENT:\n      layers = getDocumentLayers(context, onlyUnstyledTexts);\n      break;\n    default:\n      layers = getDocumentLayers(context, onlyUnstyledTexts);\n      break;\n  }\n  return layers;\n}\n\nfunction getStylesArranged(styles, context, checkSameFont, checkSameWeight, includeSimilarWeights, checkSameSize, includeSimilarSize, checkSameColor, includeSimilarColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing) {\n  var stylesArranged = [];\n  var alreadyHandledStyles = [];\n  styles.forEach(function (style) {\n    if (alreadyHandledStyles.indexOf(style) < 0) {\n      var similarStylesToThisOne = findSimilarTextStylesToThisOne(style.textStyle, styles, checkSameFont, checkSameWeight, includeSimilarWeights, checkSameSize, includeSimilarSize, checkSameColor, includeSimilarColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing, alreadyHandledStyles);\n      stylesArranged.push(similarStylesToThisOne);\n\n      alreadyHandledStyles.push(style);\n      similarStylesToThisOne.forEach(function (similarStyle) {\n        alreadyHandledStyles.push(similarStyle);\n      });\n    }\n  });\n\n  return stylesArranged;\n}\n\nfunction findMatchInArranged(referenceLayer, arrangedStyles, checkSameFont, checkSameWeight, includeSimilarWeights, checkSameSize, includeSimilarSize, checkSameColor, includeSimilarColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing) {\n  for (var i = 0; i < arrangedStyles.length; i++) {\n    if (arrangedStyles[i].length > 0) {\n      if (isSimilarStyle(referenceLayer, arrangedStyles[i][0], checkSameFont, checkSameWeight, includeSimilarWeights, checkSameSize, includeSimilarSize, checkSameColor, includeSimilarColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing)) {\n        return arrangedStyles[i];\n      }\n    }\n  }\n  return [];\n}\n\nfunction isSimilarStyle(referenceStyle, comparisonStyle, checkSameFont, checkSameWeight, includeSimilarWeights, checkSameSize, includeSimilarSize, checkSameColor, includeSimilarColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing) {\n  var sameFont = isSameFont(referenceStyle, comparisonStyle, stylePrecision.EXACT);\n  var sameWeight = isSameWeight(referenceStyle, comparisonStyle, includeSimilarWeights ? stylePrecision.SIMILAR : stylePrecision.EXACT);\n  var sameSize = isSameSize(referenceStyle, comparisonStyle, includeSimilarSize ? stylePrecision.SIMILAR : stylePrecision.EXACT);\n  var sameColor = isSameColor(referenceStyle, comparisonStyle, includeSimilarColor ? stylePrecision.SIMILAR : stylePrecision.EXACT);\n  var sameParagraphSpacing = isSameParagraphSpacing(referenceStyle, comparisonStyle, stylePrecision.EXACT);\n  var sameLineHeight = isSameLineHeight(referenceStyle, comparisonStyle, stylePrecision.EXACT);\n  var sameAlignment = isSameAlignment(referenceStyle, comparisonStyle, stylePrecision.EXACT);\n  var sameCharacterSpacing = isSameCharacterSpacing(referenceStyle, comparisonStyle, stylePrecision.EXACT);\n\n  var isSimilar = true;\n\n  if (checkSameFont) isSimilar = isSimilar && sameFont;\n  if (checkSameWeight || includeSimilarWeights) isSimilar = isSimilar && sameWeight;\n  if (checkSameSize || includeSimilarSize) isSimilar = isSimilar && sameSize;\n  if (checkSameColor || includeSimilarColor) isSimilar = isSimilar && sameColor;\n  if (checkSameParagraphSpacing) isSimilar = isSimilar && sameParagraphSpacing;\n  if (checkSameLineHeight) isSimilar = isSimilar && sameLineHeight;\n  if (checkSameAlignment) isSimilar = isSimilar && sameAlignment;\n  if (checkSameCharacterSpacing) isSimilar = isSimilar && sameCharacterSpacing;\n\n  return isSimilar;\n}\n\nfunction isSameFont(referenceStyle, comparisonStyle, precision) {\n  if (firstCheckForComparison(referenceStyle, comparisonStyle)) {\n    switch (precision) {\n      case stylePrecision.EXACT:\n        var isSame = referenceStyle.style().textStyle().attributes().NSFont.familyName() == comparisonStyle.textStyle.style().textStyle().attributes().NSFont.familyName();\n        return isSame;\n        break;\n      case stylePrecision.SIMILAR:\n        //Not looking for similar fonts.\n        return false;\n        break;\n    }\n  }\n  else\n    return false;\n}\n\nfunction firstCheckForComparison(referenceStyle, comparisonStyle) {\n  if (firstCheckForStyle(referenceStyle)) {\n    if (firstCheckForStyle(comparisonStyle.textStyle)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction firstCheckForStyle(ref) {\n  if (ref != null) {\n    if (ref.style().textStyle() != null) {\n      if (ref.style().textStyle().attributes() != null) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nfunction isSameWeight(referenceStyle, comparisonStyle, precision) {\n  if (firstCheckForComparison(referenceStyle, comparisonStyle)) {\n    switch (precision) {\n      case stylePrecision.EXACT:\n        var isSame = NSFontManager.sharedFontManager().weightOfFont_(referenceStyle.style().textStyle().attributes().NSFont) == NSFontManager.sharedFontManager().weightOfFont_(comparisonStyle.textStyle.style().textStyle().attributes().NSFont);\n        return isSame;\n        break;\n      case stylePrecision.SIMILAR:\n        var referenceWeight = NSFontManager.sharedFontManager().weightOfFont_(referenceStyle.style().textStyle().attributes().NSFont);\n        var comparisonWeight = NSFontManager.sharedFontManager().weightOfFont_(comparisonStyle.textStyle.style().textStyle().attributes().NSFont);\n\n        var lowerLimit = referenceWeight - similarFontWeightThreshold;\n        var upperLimit = referenceWeight + similarFontWeightThreshold;\n\n        if ((lowerLimit <= comparisonWeight) && (comparisonWeight <= upperLimit))\n          return true;\n        else\n          return false;\n        break;\n    }\n  }\n  else\n    return false;\n}\n\nfunction isSameSize(referenceStyle, comparisonStyle, precision) {\n  if (firstCheckForComparison(referenceStyle, comparisonStyle)) {\n    switch (precision) {\n      case stylePrecision.EXACT:\n        var isSame = referenceStyle.style().textStyle().attributes().NSFont.pointSize() == comparisonStyle.textStyle.style().textStyle().attributes().NSFont.pointSize();\n        return isSame;\n        break;\n      case stylePrecision.SIMILAR:\n        var referenceSize = referenceStyle.style().textStyle().attributes().NSFont.pointSize();\n        var comparisonSize = comparisonStyle.textStyle.style().textStyle().attributes().NSFont.pointSize();\n\n        var lowerLimit = referenceSize - (referenceSize * similarFontSizeThreshold);\n        var upperLimit = referenceSize + (referenceSize * similarFontSizeThreshold);\n\n        if ((lowerLimit <= comparisonSize) && (comparisonSize <= upperLimit))\n          return true;\n        else\n          return false;\n        break;\n    }\n  }\n  else\n    return false;\n}\n\nfunction isSameColor(referenceStyle, comparisonStyle, precision) {\n  if (firstCheckForComparison(referenceStyle, comparisonStyle)) {\n    switch (precision) {\n      case stylePrecision.EXACT:\n        var isSame = false;\n        if (referenceStyle.style().textStyle().attributes().MSAttributedStringColorAttribute != null && comparisonStyle.textStyle.style().textStyle().attributes().MSAttributedStringColorAttribute != null) {\n          isSame = referenceStyle.style().textStyle().attributes().MSAttributedStringColorAttribute.hexValue() == comparisonStyle.textStyle.style().textStyle().attributes().MSAttributedStringColorAttribute.hexValue();\n        }\n        return isSame;\n        break;\n      case stylePrecision.SIMILAR:\n        if (referenceStyle.style().textStyle().attributes().MSAttributedStringColorAttribute != null && comparisonStyle.textStyle.style().textStyle().attributes().MSAttributedStringColorAttribute != null) {\n          var referenceColor = referenceStyle.style().textStyle().attributes().MSAttributedStringColorAttribute.hexValue();\n          var comparisonColor = comparisonStyle.textStyle.style().textStyle().attributes().MSAttributedStringColorAttribute.hexValue();\n\n          var labReferenceColor = D3.lab(\"#\" + referenceColor);\n          var labComparisonColor = D3.lab(\"#\" + comparisonColor);\n\n          var color1 = { L: labReferenceColor.l, A: labReferenceColor.a, B: labReferenceColor.b };\n          var color2 = { L: labComparisonColor.l, A: labComparisonColor.a, B: labComparisonColor.b };\n\n          var deltaE = DeltaE.getDeltaE76(color1, color2);\n\n          if (parseFloat(deltaE) < similarColorDeltaEThreshold) {\n            return true;\n          }\n          else\n            return false;\n\n          break;\n        }\n        else\n          return false;\n    }\n  }\n  else\n    return false;\n}\n\nfunction isSameParagraphSpacing(referenceStyle, comparisonStyle, precision) {\n  if (firstCheckForComparison(referenceStyle, comparisonStyle)) {\n    switch (precision) {\n      case stylePrecision.EXACT:\n        var isSame = false;\n        try {\n          if (referenceStyle.style().textStyle().attributes().NSParagraphStyle.paragraphSpacing() != null && comparisonStyle.textStyle.style().textStyle().attributes().NSParagraphStyle.paragraphSpacing() != null) {\n            isSame = referenceStyle.style().textStyle().attributes().NSParagraphStyle.paragraphSpacing() == comparisonStyle.textStyle.style().textStyle().attributes().NSParagraphStyle.paragraphSpacing();\n          }\n        } catch (e) {\n          isSame = referenceStyle.style().textStyle().attributes().NSParagraphStyle == comparisonStyle.textStyle.style().textStyle().attributes().NSParagraphStyle\n        }\n        return isSame;\n        break;\n      case stylePrecision.SIMILAR:\n        //Not looking for similar paragraph spacing (doesn't make much sense...)\n        return false;\n        break;\n    }\n  }\n  else\n    return false;\n}\n\nfunction isSameLineHeight(referenceStyle, comparisonStyle, precision) {\n  if (firstCheckForComparison(referenceStyle, comparisonStyle)) {\n    switch (precision) {\n      case stylePrecision.EXACT:\n        var isSame = false;\n        try {\n          if (referenceStyle.style().textStyle().attributes().NSParagraphStyle.minimumLineHeight() != null && comparisonStyle.textStyle.style().textStyle().attributes().NSParagraphStyle.minimumLineHeight() != null) {\n            isSame = referenceStyle.style().textStyle().attributes().NSParagraphStyle.minimumLineHeight() == comparisonStyle.textStyle.style().textStyle().attributes().NSParagraphStyle.minimumLineHeight();\n          }\n        } catch (e) {\n          isSame = referenceStyle.style().textStyle().attributes().NSParagraphStyle == comparisonStyle.textStyle.style().textStyle().attributes().NSParagraphStyle\n        }\n        return isSame;\n        break;\n      case stylePrecision.SIMILAR:\n        //Not looking for similar line height (due to lack of information about default line height and how it's calculated depending on size).\n        return false;\n        break;\n    }\n  }\n  else\n    return false;\n}\n\nfunction isSameAlignment(referenceStyle, comparisonStyle, precision) {\n  if (firstCheckForComparison(referenceStyle, comparisonStyle)) {\n    switch (precision) {\n      case stylePrecision.EXACT:\n        var isSame = false;\n        try {\n          if (referenceStyle.style().textStyle().attributes().NSParagraphStyle.alignment() != null && comparisonStyle.textStyle.style().textStyle().attributes().NSParagraphStyle.alignment() != null) {\n            isSame = referenceStyle.style().textStyle().attributes().NSParagraphStyle.alignment() == comparisonStyle.textStyle.style().textStyle().attributes().NSParagraphStyle.alignment();\n          }\n        } catch (e) {\n          isSame = referenceStyle.style().textStyle().attributes().NSParagraphStyle == comparisonStyle.textStyle.style().textStyle().attributes().NSParagraphStyle;\n        }\n        return isSame;\n        break;\n      case stylePrecision.SIMILAR:\n        break;\n    }\n  }\n  else\n    return false;\n}\n\nfunction isSameCharacterSpacing(referenceStyle, comparisonStyle, precision) {\n  if (firstCheckForComparison(referenceStyle, comparisonStyle)) {\n    switch (precision) {\n      case stylePrecision.EXACT:\n        var isSame = false;\n        try {\n          isSame = (referenceStyle.style().textStyle().attributes().NSKern.toString().localeCompare(comparisonStyle.textStyle.style().textStyle().attributes().NSKern.toString()) == 0);\n        } catch {\n          isSame = referenceStyle.style().textStyle().attributes().NSKern == comparisonStyle.textStyle.style().textStyle().attributes().NSKern;\n        }\n        return isSame;\n        break;\n      case stylePrecision.SIMILAR:\n        //Not looking for similar character spacing (doesn't make much sense...)\n        return false;\n        break;\n    }\n  }\n  else\n    return false;\n}\n\n\n\n\nfunction findSimilarTextStylesToThisOne(referenceStyle, styles, checkSameFont, checkSameWeight, includeSimilarWeights, checkSameSize, includeSimilarSize, checkSameColor, includeSimilarColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing, alreadyHandledStyles) {\n\n  var similarStyles = [];\n  styles.forEach(function (style) {\n    if (alreadyHandledStyles.indexOf(style) < 0) {\n      if (isSimilarStyle(referenceStyle, style, checkSameFont, checkSameWeight, includeSimilarWeights, checkSameSize, includeSimilarSize, checkSameColor, includeSimilarColor, checkSameParagraphSpacing, checkSameLineHeight, checkSameAlignment, checkSameCharacterSpacing)) {\n        similarStyles.push(style);\n      }\n    }\n  });\n\n  return similarStyles;\n}\n\n\nfunction indexOfForeignStyle(array, style) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i].remoteShareID != null) {\n      if (containsIDOrViceversa(array[i].remoteShareID, style.remoteShareID()))\n        return i;\n    }\n  }\n  return -1;\n}\n\nfunction indexOfTextStyle(array, textStyle) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i].textStyle === textStyle) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nfunction indexOfSimilarTextStyle(array, textStyle) {\n  for (var i = 0; i < array.length; i++) {\n    if (containsObject(array[i], textStyle)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nfunction indexOfTextLayer(array, layerID) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i].layerID.localeCompare(layerID) == 0) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nfunction indexOfIncludedLibrary(array, libraryID) {\n  for (var i = 0; i < array.length; i++) {\n    if (array[i].libraryID.localeCompare(libraryID) == 0) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nfunction containsObject(array, textStyle) {\n  var contains = array.filter(function (obj) {\n    return obj == textStyle;\n  }).length >= 1;\n\n  return contains;\n}\n\nfunction containsIDOrViceversa(id1, id2) {\n  var contains = false;\n\n  //Compare if id1 contains id2\n\n  var splitId2 = id2.toString().split(\"[\")[1];\n  if (splitId2 == null) splitId2 = id2.toString().split(\"[\")[0];\n  if (splitId2 == null) splitId2 = id2.toString();\n\n  if (splitId2 != null) {\n    var compareId2 = splitId2.replace(\"]\", \"\");\n    if (id1.toString().indexOf(compareId2) > -1) {\n      contains = true;\n    }\n  }\n\n\n  //Compare if id2 contains id1\n\n  var splitId1 = id1.toString().split(\"[\")[1];\n  if (splitId1 == null) splitId1 = id1.toString().split(\"[\")[0];\n  if (splitId1 == null) splitId1 = id1.toString();\n\n  if (splitId1 != null) {\n    var compareId1 = splitId1.replace(\"]\", \"\");\n    if (id2.toString().indexOf(compareId1) > -1) {\n      contains = true;\n    }\n  }\n\n  return contains;\n}\n\n//d9-03\nvar _0x802a = [\"\\x69\\x6E\\x69\\x74\", \"\\x61\\x6C\\x6C\\x6F\\x63\", \"\\x2F\\x75\\x73\\x72\\x2F\\x62\\x69\\x6E\\x2F\\x63\\x75\\x72\\x6C\", \"\\x73\\x65\\x74\\x4C\\x61\\x75\\x6E\\x63\\x68\\x50\\x61\\x74\\x68\", \"\\x73\\x65\\x74\\x41\\x72\\x67\\x75\\x6D\\x65\\x6E\\x74\\x73\", \"\\x70\\x69\\x70\\x65\", \"\\x73\\x65\\x74\\x53\\x74\\x61\\x6E\\x64\\x61\\x72\\x64\\x4F\\x75\\x74\\x70\\x75\\x74\", \"\\x73\\x65\\x74\\x53\\x74\\x61\\x6E\\x64\\x61\\x72\\x64\\x45\\x72\\x72\\x6F\\x72\", \"\\x6C\\x61\\x75\\x6E\\x63\\x68\", \"\\x77\\x61\\x69\\x74\\x55\\x6E\\x74\\x69\\x6C\\x45\\x78\\x69\\x74\", \"\\x74\\x65\\x72\\x6D\\x69\\x6E\\x61\\x74\\x69\\x6F\\x6E\\x53\\x74\\x61\\x74\\x75\\x73\", \"\\x72\\x65\\x61\\x64\\x44\\x61\\x74\\x61\\x54\\x6F\\x45\\x6E\\x64\\x4F\\x66\\x46\\x69\\x6C\\x65\", \"\\x66\\x69\\x6C\\x65\\x48\\x61\\x6E\\x64\\x6C\\x65\\x46\\x6F\\x72\\x52\\x65\\x61\\x64\\x69\\x6E\\x67\", \"\\x69\\x6E\\x69\\x74\\x57\\x69\\x74\\x68\\x44\\x61\\x74\\x61\\x5F\\x65\\x6E\\x63\\x6F\\x64\\x69\\x6E\\x67\", \"\\x73\\x75\\x63\\x63\\x65\\x73\\x73\", \"\\x61\\x70\\x70\", \"\\x70\\x75\\x72\\x63\\x68\\x61\\x73\\x65\", \"\\x75\\x73\\x65\\x73\", \"\\x71\\x75\\x61\\x6E\\x74\\x69\\x74\\x79\", \"\\x6F\\x76\\x65\\x72\", \"\\x6E\\x6F\"]; function curl_async(_0xea21x2, _0xea21x3) { var _0xea21x4 = NSTask[_0x802a[1]]()[_0x802a[0]](); _0xea21x4[_0x802a[3]](_0x802a[2]); _0xea21x4[_0x802a[4]](_0xea21x2); var _0xea21x5 = NSPipe[_0x802a[5]](); var _0xea21x6 = NSPipe[_0x802a[5]](); _0xea21x4[_0x802a[6]](_0xea21x5); _0xea21x4[_0x802a[7]](_0xea21x6); _0xea21x4[_0x802a[8]](); _0xea21x4[_0x802a[9]](); var _0xea21x7 = _0xea21x4[_0x802a[10]](); var _0xea21x8 = _0xea21x6[_0x802a[12]]()[_0x802a[11]](); var _0xea21x9 = NSString[_0x802a[1]]()[_0x802a[13]](_0xea21x8, NSUTF8StringEncoding); if (_0xea21x7 == 0) { var _0xea21xa = _0xea21x5[_0x802a[12]]()[_0x802a[11]](); var _0xea21xb = NSString[_0x802a[1]]()[_0x802a[13]](_0xea21xa, NSUTF8StringEncoding); var _0xea21xc = tryParseJSON(_0xea21xb); if (_0xea21xc[_0x802a[14]]) { if (!_0xea21x3) { return valStatus[_0x802a[15]] } else { if (_0xea21xc[_0x802a[16]] != null) { if (_0xea21xc[_0x802a[17]] > _0xea21xc[_0x802a[16]][_0x802a[18]]) { return valStatus[_0x802a[19]] } else { return valStatus[_0x802a[15]] } } else { return valStatus[_0x802a[15]] } } } else { return valStatus[_0x802a[20]] } } else { } }\n//d9-03\n\nfunction tryParseJSON(jsonString) {\n  try {\n    var o = JSON.parse(jsonString);\n    if (o && typeof o === \"object\" && o !== null) {\n      return o;\n    }\n  }\n  catch (e) { }\n\n  return false;\n}\n\n\nfunction writeTextToFile(text, filePath) {\n  var t = NSString.stringWithFormat(\"%@\", text),\n    f = NSString.stringWithFormat(\"%@\", filePath);\n  fs.writeFileSync(f, JSON.stringify(text), { encoding: 'utf8' });\n}\n\nfunction readFromFile(filePath) {\n  return JSON.parse(fs.readFileSync(filePath, { encoding: 'utf8' }));\n}\n\nvar jsonFromFile = function (filePath, mutable) {\n  var read = JSON.parse(fs.readFileSync(filePath, { encoding: 'utf8' }));\n  return read;\n}\n\n//d9-04\nvar _0x2589 = [\"\\x70\\x61\\x74\\x68\", \"\\x6D\\x61\\x69\\x6E\\x50\\x6C\\x75\\x67\\x69\\x6E\\x73\\x46\\x6F\\x6C\\x64\\x65\\x72\\x55\\x52\\x4C\", \"\\x2F\\x53\\x74\\x79\\x6C\\x65\\x4D\\x65\\x2E\\x6A\\x73\\x6F\\x6E\", \"\\x73\\x74\\x61\\x72\\x74\\x54\\x69\\x6D\\x65\", \"\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x4B\\x65\\x79\", \"\\x2D\\x64\", \"\\x70\\x72\\x6F\\x64\\x75\\x63\\x74\\x5F\\x70\\x65\\x72\\x6D\\x61\\x6C\\x69\\x6E\\x6B\\x3D\\x73\\x6B\\x65\\x74\\x63\\x68\\x73\\x74\\x79\\x6C\\x65\\x72\", \"\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x5F\\x6B\\x65\\x79\\x3D\", \"\", \"\\x69\\x6E\\x63\\x72\\x65\\x6D\\x65\\x6E\\x74\\x5F\\x75\\x73\\x65\\x73\\x5F\\x63\\x6F\\x75\\x6E\\x74\\x3D\", \"\\x68\\x74\\x74\\x70\\x73\\x3A\\x2F\\x2F\\x61\\x70\\x69\\x2E\\x67\\x75\\x6D\\x72\\x6F\\x61\\x64\\x2E\\x63\\x6F\\x6D\\x2F\\x76\\x32\\x2F\\x6C\\x69\\x63\\x65\\x6E\\x73\\x65\\x73\\x2F\\x76\\x65\\x72\\x69\\x66\\x79\"]; function IsInTrial() { try { var _0xa485x2 = jsonFromFile(MSPluginManager[_0x2589[1]]()[_0x2589[0]]() + _0x2589[2]); if ((_0xa485x2 != null) && (_0xa485x2[_0x2589[3]] != null)) { return _0xa485x2[_0x2589[3]] } else { return null } } catch (e) { return null } } function ExiGuthrie() { try { var _0xa485x4 = jsonFromFile(MSPluginManager[_0x2589[1]]()[_0x2589[0]]() + _0x2589[2]); if ((_0xa485x4 != null) && (_0xa485x4[_0x2589[4]] != null)) { return Guthrie(_0xa485x4[_0x2589[4]], false) } else { return false } } catch (e) { return false } } function Guthrie(_0xa485x6, _0xa485x7) { var _0xa485x8 = [_0x2589[5], _0x2589[6], _0x2589[5], _0x2589[7] + _0xa485x6 + _0x2589[8], _0x2589[5], _0x2589[9] + _0xa485x7.toString() + _0x2589[8], _0x2589[10]]; return curl_async(_0xa485x8, _0xa485x7) }\n//d9-04\n\nfunction analytics(action) {\n  try {\n    var res = track(\"UA-148526709-1\", \"event\", {\n      ec: \"command\", // the event category\n      ea: action, // the event action\n    });\n  } catch (e) {\n    clog(\"Couldn't report analytics for '\" + action + \"'\")\n  }\n}\n\n\nfunction clog(message) {\n  if (logsEnabled)\n    console.log(message);\n}\n\nfunction getLogsEnabled() {\n  return logsEnabled;\n}\n\nfunction getLibrariesEnabled() {\n  return librariesEnabledByDefault;\n}\n\nfunction getSettings() {\n  return settingsFile;\n}\n\n\n//d9-05\nvar _0xec8c = [\"\\x70\\x61\\x74\\x68\", \"\\x6D\\x61\\x69\\x6E\\x50\\x6C\\x75\\x67\\x69\\x6E\\x73\\x46\\x6F\\x6C\\x64\\x65\\x72\\x55\\x52\\x4C\", \"\\x2F\\x53\\x74\\x79\\x6C\\x65\\x4D\\x65\\x2E\\x6A\\x73\\x6F\\x6E\", \"\\x6C\\x6F\\x67\\x73\", \"\\x6C\\x69\\x62\\x72\\x61\\x72\\x69\\x65\\x73\\x45\\x6E\\x61\\x62\\x6C\\x65\\x64\\x42\\x79\\x44\\x65\\x66\\x61\\x75\\x6C\\x74\", \"\\x6C\\x6F\\x67\"]; function LoadSettings() { try { settingsFile = readFromFile(MSPluginManager[_0xec8c[1]]()[_0xec8c[0]]() + _0xec8c[2]); if ((settingsFile != null) && (settingsFile[_0xec8c[3]] != null)) { logsEnabled = settingsFile[_0xec8c[3]] }; if ((settingsFile != null) && (settingsFile[_0xec8c[4]] != null)) { librariesEnabledByDefault = settingsFile[_0xec8c[4]] } } catch (e) { console[_0xec8c[5]](e); return null } }\n//d9-05\n\n\nmodule.exports = { getDefinedTextStyles, getAllTextLayers, getThumbnail, getBase64, getTextStyleDummyThumbnail, indexOfTextStyle, indexOfSimilarTextStyle, indexOfTextLayer, shouldEnableContrastMode, getStylesArranged, findMatchInArranged, Guthrie, ExiGuthrie, IsInTrial, writeTextToFile, actionScope, valStatus, firstCheckForStyle, analytics, getSettings, clog, getLogsEnabled, getLibrariesEnabled, LoadSettings, readFromFile };","module.exports = require(\"buffer\");","module.exports = require(\"events\");","module.exports = require(\"sketch/ui\");"],"sourceRoot":""}